[
    {
        "id": "217d4457bda21c0d",
        "type": "tab",
        "label": "API Handling",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "7af354fb2230bd6b",
        "type": "tab",
        "label": "Redis",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2751cff285e8ba2d",
        "type": "tab",
        "label": "Firebase",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "dd62ac133fb1360c",
        "type": "tab",
        "label": "JugEnterprise (Dashboard)",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "4c20aa2ac87fc1e6",
        "type": "tab",
        "label": "Godot",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "8ae59feea1fac0e6",
        "type": "subflow",
        "name": "Handle existance of email and pw",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "8e7d846effd9e3d7"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1260,
                "y": 220,
                "wires": [
                    {
                        "id": "7837703e879a4a5c",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1260,
                "y": 120,
                "wires": [
                    {
                        "id": "68a2107c3e0d91ed",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "3a056c2d95c24d79",
        "type": "subflow",
        "name": "Verify email and pw",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "68fcddddc6fb266a"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1300,
                "y": 180,
                "wires": [
                    {
                        "id": "eb01921b49e9b9ed",
                        "port": 0
                    }
                ]
            },
            {
                "x": 780,
                "y": 260,
                "wires": [
                    {
                        "id": "c9342c2ae65773a2",
                        "port": 1
                    },
                    {
                        "id": "346b27e6057f0e34",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "b6b33a23690f53f3",
        "type": "subflow",
        "name": "Create Thing (Thingworx)",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 100,
                "wires": [
                    {
                        "id": "c4bdcc33cbf74d3f"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "98b9aea3ec541c1d",
        "type": "subflow",
        "name": "Create Thing (DB)",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "111121c67e0c3d75"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 900,
                "y": 80,
                "wires": [
                    {
                        "id": "17a95012080ff363",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "3642f44d746371ee",
        "type": "subflow",
        "name": "Update filter (DB & Thingworx)",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "b6b4dc96767b01fb"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1260,
                "y": 200,
                "wires": [
                    {
                        "id": "9805503f4874d425",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "fa232f5df39eb96b",
        "type": "subflow",
        "name": "Clean Things (Thingworx)",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "325c4faa337cc671"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1080,
                "y": 120,
                "wires": [
                    {
                        "id": "d824589b06d07a80",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "bf3376f998e1b263",
        "type": "subflow",
        "name": "Compare passwords",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "c381f2a70245441b"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1140,
                "y": 60,
                "wires": [
                    {
                        "id": "f1a90bc89958c9af",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1140,
                "y": 120,
                "wires": [
                    {
                        "id": "f1a90bc89958c9af",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "e6c0f715714d0f23",
        "type": "subflow",
        "name": "Check ownership",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 140,
                "wires": [
                    {
                        "id": "a28cd932aa8b670a"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1000,
                "y": 140,
                "wires": [
                    {
                        "id": "c04b38ae73eb9b2d",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "1589093497ae43e3",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Pair Request from Jug to add it to DB and ThingWorx",
        "style": {
            "label": true
        },
        "nodes": [
            "f5c3aee0864a46be",
            "378b9baed000b7e6",
            "99c1e01bcdde1e9a",
            "a55abe65144b7b0c",
            "dcd2b471dd5d1d54",
            "fa470500be985961",
            "70e3419b45428f51",
            "581e57b5ed15ddce",
            "b79303726be56dc6",
            "27ad1b042019570d",
            "9935b7fb6f9babfb"
        ],
        "x": 34,
        "y": 679,
        "w": 1252,
        "h": 182
    },
    {
        "id": "bdbaa79edcd82992",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "User Registration HTTP Request",
        "style": {
            "label": true
        },
        "nodes": [
            "e617a36252101d98",
            "9f2b775c5e24acb8",
            "10b809801dba4bcb",
            "c80edb6648fb5c23",
            "da290a44a03ac8ee",
            "3e6ab8f278a930ef",
            "c2d7c74e09b2e312",
            "6addd85ab87497c3",
            "a9f71d3d32f804d1",
            "7bc253d919b1346f",
            "a71d36987d32f7d6"
        ],
        "x": 34,
        "y": 19,
        "w": 1252,
        "h": 242
    },
    {
        "id": "cb681741da812fc7",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "User Login HTTP Request",
        "style": {
            "label": true
        },
        "nodes": [
            "4f6f6fac724a496a",
            "5c3d7fd931d482a9",
            "7b80c134f08a63b6",
            "6737c839da4aeeab",
            "594f99b964435f02",
            "a4b68c47b965d3f2",
            "2c0f67140fd1b413",
            "40ce6893f6966a45",
            "339436e98d838faf",
            "516f8568ef9efb35",
            "3694c41146d5c40c",
            "c6ca80c6a903e7ac",
            "336698c71763f8d9",
            "7b7a4bdf6c1331b2",
            "1af63daa2efef9de"
        ],
        "x": 34,
        "y": 299,
        "w": 1252,
        "h": 342
    },
    {
        "id": "20496de9b60de6a8",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Update Filter Capacity Request",
        "style": {
            "label": true
        },
        "nodes": [
            "a22ecd30043c6866",
            "3045dac9484f5175",
            "86072dca8a4675b9",
            "7fe99103bea3c313",
            "15a4b9f0df755521",
            "8962bee34f1ecb3d",
            "06749a30d3205d94",
            "841f478027e2f418",
            "28d97bfdb5c2a53a"
        ],
        "x": 34,
        "y": 899,
        "w": 1252,
        "h": 162
    },
    {
        "id": "ef04f78fe84031f4",
        "type": "group",
        "z": "e6c0f715714d0f23",
        "name": "Ensure user own provided jug",
        "style": {
            "label": true
        },
        "nodes": [
            "a28cd932aa8b670a",
            "c04b38ae73eb9b2d"
        ],
        "x": 134,
        "y": 99,
        "w": 472,
        "h": 82
    },
    {
        "id": "261acb4b06f35df7",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Jug Count",
        "style": {
            "label": true
        },
        "nodes": [
            "fffcf2415ff35daf",
            "e12e139248b70364",
            "6426c3f9917d2081",
            "ed3067e7caae1618",
            "33457bfaf6556358"
        ],
        "x": 314,
        "y": 1099,
        "w": 792,
        "h": 162
    },
    {
        "id": "f78c38617ed627c9",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Change User Email Request",
        "style": {
            "label": true
        },
        "nodes": [
            "0e902976e72968fd",
            "419b5ed523e9346f",
            "972ae2bb601df8f1",
            "91f42fd977778f76",
            "8e2288be6eecf071",
            "85468fb5347ae2b0",
            "5e97cee8836acfbc",
            "c243a77177af6c13",
            "38ba2f89ca333620"
        ],
        "x": 34,
        "y": 1099,
        "w": 1252,
        "h": 162
    },
    {
        "id": "2d8f9ba287e5298a",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Change User Password Request",
        "style": {
            "label": true
        },
        "nodes": [
            "52c86537f1269879",
            "181a7d2e9fcd4401",
            "56503f67950889f9",
            "035d90da9f82f6ee",
            "dda3f2e8d089d3b3",
            "9b2e1ee643f77b0a",
            "366863cb4e5f7bf2",
            "fb45f15a6ea25bf8",
            "e4316e93ff7c043c",
            "893577be1c16039b",
            "96074f98dd6204c8",
            "18c0792f01784136",
            "0f30d5fb290b42b3",
            "b235729f20069b7d",
            "fb7710509a9b6ed8"
        ],
        "x": 34,
        "y": 1299,
        "w": 1312,
        "h": 242
    },
    {
        "id": "85cf4f26a7c39064",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Account Deletion Request",
        "style": {
            "label": true
        },
        "nodes": [
            "2a9796619308d20a",
            "98bdb442331f9b81",
            "0e21d86ce0178699",
            "e9961cce33071acc",
            "7863615649b984e9",
            "02dfd341a8807e9a",
            "185774d4d094bfe0",
            "5b06d76a9679e1cb",
            "a7d0411b8d68b5a1",
            "357366d052222e44"
        ],
        "x": 34,
        "y": 1579,
        "w": 1312,
        "h": 162
    },
    {
        "id": "f74c838012730271",
        "type": "group",
        "z": "4c20aa2ac87fc1e6",
        "name": "Godot Simulator",
        "style": {
            "label": true
        },
        "nodes": [
            "eb0e1351ff4cb256",
            "14f845b4086a8052"
        ],
        "x": 134,
        "y": 99,
        "w": 492,
        "h": 82
    },
    {
        "id": "d0158497c3f88bb8",
        "type": "group",
        "z": "b6b33a23690f53f3",
        "name": "ThingWorx Interfacing",
        "style": {
            "label": true
        },
        "nodes": [
            "ce16f9573b804d91",
            "6f1e5e7364d80697",
            "12d7faae89458ea7",
            "5abf18101812be96",
            "505ccfe324b1de17"
        ],
        "x": 294,
        "y": 159,
        "w": 612,
        "h": 182
    },
    {
        "id": "99bd9f011057c2f8",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "User Count",
        "style": {
            "label": true
        },
        "nodes": [
            "96122b6e803914d0",
            "c38392d9d315dc5d",
            "5415beb9fff2b624",
            "2e8fa7ec9d191f25",
            "e7bd29cb35dc2be0"
        ],
        "x": 314,
        "y": 1299,
        "w": 792,
        "h": 162
    },
    {
        "id": "d8af04f52759052d",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Plastic saving computation",
        "style": {
            "label": true
        },
        "nodes": [
            "6cc1040bfd802f1e",
            "bf3e55578af7a2e4",
            "3ef85ed4716564ae",
            "fa768fe8dd244a44",
            "1b5612176c75fd15",
            "ae2b33962a87399a",
            "a492687f220674ec",
            "0956b5d39aba1b9f",
            "cc54a4dbd8fd882f",
            "a4d6a0147eedd8e8",
            "daa275236cb1cf09"
        ],
        "x": 314,
        "y": 839,
        "w": 792,
        "h": 222
    },
    {
        "id": "e5db3ff7e0f7bdc2",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Low-filter alerts information",
        "style": {
            "label": true
        },
        "nodes": [
            "fb708c2fcfc9c453",
            "c2d21a8e765e0a8d",
            "f9bff4e17ea17d24",
            "f00e83fd74bdad42",
            "6dde29be83f4a808",
            "17ca1b2582d81a62",
            "e3ece40c497798c1",
            "3d45bdf91619d41e"
        ],
        "x": 314,
        "y": 599,
        "w": 1012,
        "h": 202
    },
    {
        "id": "44ca8a1c36ba7dc9",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Total litres information",
        "style": {
            "label": true
        },
        "nodes": [
            "12d815057cd57334",
            "e2b41d91cb228409",
            "cdb712ef947b9f93",
            "cd95edaaaf747c92",
            "4eb1c96a4b440d38",
            "72d7683f247d4f7a",
            "b1bfa462b34b5621",
            "a3cf40fceacb65df"
        ],
        "x": 314,
        "y": 219,
        "w": 1032,
        "h": 162
    },
    {
        "id": "2a6fd50769b56baf",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Active jug computation",
        "style": {
            "label": true
        },
        "nodes": [
            "2ad5bd5afacb1fd8",
            "c82c75d3b593411b",
            "0c96d057bbeba1ac",
            "04502fd62b09576f",
            "fcc269dc861c255c"
        ],
        "x": 314,
        "y": 419,
        "w": 1012,
        "h": 142
    },
    {
        "id": "07434671c4362d4f",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Extracting each jug id",
        "style": {
            "label": true
        },
        "nodes": [
            "686e392549632634",
            "0f36aa3917d94588",
            "43eb9f6208742902"
        ],
        "x": 314,
        "y": 79,
        "w": 512,
        "h": 82
    },
    {
        "id": "85f31b0f7e802da4",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Error Handling",
        "style": {
            "stroke": "#ff3f3f",
            "label": true,
            "color": "#ff3f3f"
        },
        "nodes": [
            "9a21dec140558ec4",
            "9eb6688fb3790834",
            "48549ff50829816e",
            "451e852607a62c46",
            "e55c49e819e6e582",
            "0d496130a175a9fe",
            "ebae16586d820da2"
        ],
        "x": 314,
        "y": 1719,
        "w": 892,
        "h": 122
    },
    {
        "id": "d4ecc9458d879224",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Error Handling",
        "style": {
            "stroke": "#ff3f3f",
            "label": true,
            "color": "#ff3f3f"
        },
        "nodes": [
            "f886d4659e9bc7b2",
            "98c6aa8214050734",
            "d60a99a7a42e13aa",
            "fd8dcfa9337350f6",
            "b4bc44fd8fd0d81f",
            "fd7954efe8da413c",
            "aed1bb2bfb8d429a",
            "6fc6bab94a4ae8e3",
            "019d6130afe1d91d",
            "5820aa3bb72d4b30"
        ],
        "x": 34,
        "y": 4539,
        "w": 1312,
        "h": 202
    },
    {
        "id": "dd69043d1cb5236a",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Show / Clean UserTable",
        "style": {
            "label": true,
            "stroke": "#0070c0",
            "color": "#0070c0"
        },
        "nodes": [
            "3c434ec046f71a23",
            "83c99c7142a96e7f",
            "5898347def636b4d",
            "d0c5bf7405388a7c",
            "c98c52a08de3b558",
            "367f5704e274bbf0",
            "82e4247a771226d0",
            "8f712530a5c66d57",
            "50f589db459557ce"
        ],
        "x": 34,
        "y": 4299,
        "w": 632,
        "h": 202
    },
    {
        "id": "2014e345587e4007",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Show / Clean JugTable",
        "style": {
            "label": true,
            "stroke": "#0070c0",
            "color": "#0070c0"
        },
        "nodes": [
            "801868f4cc631259",
            "28705e872a39bf64",
            "1cd3cb4c7a6a6292",
            "f8e038c0ae26a12a",
            "4810de2e5fcc3538",
            "bad79e1fd1d22d16"
        ],
        "x": 714,
        "y": 4299,
        "w": 632,
        "h": 202
    },
    {
        "id": "8b12de2fdf899788",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Return Jugs from Account",
        "style": {
            "label": true
        },
        "nodes": [
            "c7d12a04bb0c7cc3",
            "98f18f7a7a288504",
            "1cfcbe763e4966cd",
            "ec9eb5085c4a8fe1",
            "d9e203587f3d77f1",
            "0f8de66e8416d0a1",
            "ca273c111a09dc87",
            "7603bf0f721ecf7a",
            "9cd4aacb75e41236",
            "9034a056bc11e4cd",
            "3fc7f576baa8f340",
            "8e020c02f1d5bca5",
            "1356342fe4014956",
            "63e674961c23831c"
        ],
        "x": 34,
        "y": 1959,
        "w": 1312,
        "h": 202
    },
    {
        "id": "24db0ec2768119c9",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Delete Jug from User",
        "style": {
            "label": true
        },
        "nodes": [
            "e978e5b480cfcf05",
            "29bf6d8e0cfbd548",
            "2c01cab46f92f6bc",
            "dfa5ae5d5416ad40",
            "97a10cbacf03277e",
            "aa8199b9c92b6b43",
            "30f9c95a1522a625",
            "2bb3eaec03c0dc95",
            "574a4b59ef9c857c",
            "12f171e5e2f97465",
            "739fe77fb6b1077a"
        ],
        "x": 34,
        "y": 2199,
        "w": 1312,
        "h": 142
    },
    {
        "id": "b1b492ef5f16e6c1",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Rename Jug from Account",
        "style": {
            "label": true
        },
        "nodes": [
            "2066612c8c9eee2a",
            "d600bb276f59c790",
            "ecc2bae2ea58566d",
            "cda6c2362dcb7726",
            "d19accf56a5f8b81",
            "6dd0e3ed1b81fb3f",
            "47a6f97b12ee7513",
            "04498a2c6e846273",
            "4f141f46c11c181f",
            "47e2ea0a595f5919",
            "5179787add360544"
        ],
        "x": 34,
        "y": 1779,
        "w": 1312,
        "h": 142
    },
    {
        "id": "534ca73506fdba18",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Total Litres",
        "style": {
            "label": true
        },
        "nodes": [
            "88c0d713d6e98b81",
            "c88dec8b993f57ff",
            "5747a2e1c597aa27",
            "6019fa6e45874eea",
            "d8773bd61cacfc72",
            "c0a3cc43ed240f5b",
            "6cf677b0282e4e6f",
            "8abf7961e74bc0f3",
            "1d5006ae514a9d60",
            "a180b3c529b92aa1",
            "8fca74c27b697c58",
            "cae422b184195e66",
            "503fc13e9fcc1e71",
            "939b30d576b816e8",
            "9242f268ceac5f80",
            "774fa1af8fabcee4",
            "4f0f929e2bdad8b1",
            "7e1934dff3a0a28a"
        ],
        "x": 34,
        "y": 2379,
        "w": 1312,
        "h": 202
    },
    {
        "id": "5e37b1309f768c0f",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Total Filtered",
        "style": {
            "label": true
        },
        "nodes": [
            "70275bf9e69b31a8",
            "add5b2a33074ecf2",
            "f30c4b594973b6d0",
            "5aca1b2252a4f596",
            "3c48160706d578ce",
            "9e33abf723222f89",
            "26e46da1d1e5c3bb",
            "08f34fd90c64243a",
            "62926aadba5250c7",
            "fcbf3708e8ee6bd1",
            "fe16e53c828639c6",
            "c9e6d57afaa2e1d2",
            "d382bf1a389a091e",
            "c4187b0eda16efb5",
            "8ad121c2a63547a7",
            "9e47f17e93f6f62a",
            "f508643b3ae7fa41",
            "230126dfbb980168"
        ],
        "x": 34,
        "y": 2619,
        "w": 1312,
        "h": 202
    },
    {
        "id": "de8fe453c32044e8",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Mean of 3 Days Litres",
        "style": {
            "label": true
        },
        "nodes": [
            "5e7b335abac55f6c",
            "d162030e97e8b68c",
            "b367f3ce524cfd94",
            "8dc11046a4b37f58",
            "450a2702b61f60ee",
            "866d839117c6f488",
            "153cd872af333754",
            "f8c7d288452c7856",
            "4d2a45258ed875aa",
            "8234a0063469656b",
            "197c21e031466f25",
            "13fa1725812d2a11",
            "76e804587421f2c6",
            "cfb0f979ae8433ec",
            "723b1a0e46b922e9",
            "20c748153a94c4d3",
            "8caf1e9a1af62b24",
            "d7feb0b9d9fb0c7f",
            "94db9507db559498"
        ],
        "x": 34,
        "y": 2859,
        "w": 1312,
        "h": 282
    },
    {
        "id": "38063613653e8a1a",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Handle user activity from Redis",
        "style": {
            "label": true
        },
        "nodes": [
            "ba928c6f3cbb3d2a",
            "03f0f11ab805879e",
            "6f73efdd004966a4",
            "f4b3f90ad6ba0cda",
            "6a11b96d12bac454",
            "f9fb5265d504b778",
            "0cedf5ca6574b456",
            "b451c92a53a5cad0",
            "c61ed3ee177c18b6",
            "6595481df1f98efd",
            "a2a3b1eb4e88c290",
            "ba7f434ec626a3de",
            "b5a9c745b6311f75",
            "347d9f4ea62ff99c",
            "e92695e056a65f95",
            "9658923e20f54f1d",
            "469cb585e1809695",
            "67610ee6c5d7a538",
            "14d37406895bec8d",
            "7018ca34006a871a",
            "5b48393db4e27cf6",
            "99e53198b6af5126",
            "bb3c30d868248d31",
            "42cb9c76c9a980d2",
            "b0ee92db4b65ba08"
        ],
        "x": 44,
        "y": 99,
        "w": 1162,
        "h": 262
    },
    {
        "id": "b4ccca51421e7bbd",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Update Total Litres for Redis",
        "style": {
            "label": true
        },
        "nodes": [
            "f52f87f8bdfaeeae",
            "71c22c22246715dd",
            "ab335792236b7f7e",
            "87b2ec98fde60d9b",
            "3bc7dbfaf2527fba"
        ],
        "x": 44,
        "y": 399,
        "w": 732,
        "h": 82
    },
    {
        "id": "519e102431c6adfb",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Handle error",
        "style": {
            "stroke": "#ff0000",
            "label": true,
            "color": "#ff0000"
        },
        "nodes": [
            "8b4c024a3605a5a6",
            "25d8bbe0d875987c",
            "face9a42b4eb7c11",
            "832ad02bc89947a0"
        ],
        "x": 54,
        "y": 1099,
        "w": 752,
        "h": 122
    },
    {
        "id": "e781aa7211d99e25",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Update Daily Litres for Redis",
        "style": {
            "label": true
        },
        "nodes": [
            "47bed87945d83ae7",
            "bb0181636da5a32c",
            "77ca70b72d5388f6",
            "cad543a44ef8ac79",
            "768a9020e1322e49",
            "e17f38b724cef952",
            "31ff0273f34611eb",
            "e5460c07c86d70f6",
            "4034126e43898b85",
            "a175f8a745e83e2f",
            "2e951943e6dc5046",
            "345e9507d7a3b201",
            "467b19b451346f48",
            "662638515caf474e"
        ],
        "x": 44,
        "y": 759,
        "w": 1102,
        "h": 302
    },
    {
        "id": "e629f80dbbf9bdfe",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Update Total filtered for Redis",
        "style": {
            "label": true
        },
        "nodes": [
            "661d4502910d1445",
            "0a68b2785038f103",
            "be6d0c370fa944fd",
            "675d2f9aa578f26f",
            "ab20fd40b692ceb9"
        ],
        "x": 44,
        "y": 519,
        "w": 732,
        "h": 82
    },
    {
        "id": "e39613053ecf19ba",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Hour Litres",
        "style": {
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "acf957f36e4d2248",
            "0ea290e2c6ce4a1a",
            "88989c2a21970a31",
            "cfa4d8d001d2130d",
            "14cf398477bf26d0",
            "1e46f3a730e93865",
            "b2e7b4682286c0d4",
            "44eae3f24c85b15b",
            "8aa960d00c5a8ae4",
            "eacd17a053e0779c",
            "ef9ce4c7d61198bc",
            "ec7c071b469780f2",
            "7eba711de7147311",
            "989d130aaff9ec32",
            "7d7228fcaa48450a",
            "e44fe8f17ee918f9",
            "95ce10a1ba7f36bf",
            "ac4c21fa9e6f4081",
            "79d9fa22339e49fa"
        ],
        "x": 34,
        "y": 3179,
        "w": 1312,
        "h": 282
    },
    {
        "id": "87a70ae14006afaf",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Last Week Litres",
        "style": {
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "cc10d96d6ab81846",
            "87169dea62c41da2",
            "1418c2b5174cb0ae",
            "7dea54595b2f8973",
            "ba2885d89716e281",
            "ec027404c17ab3fd",
            "aba17aa9b2a924c5",
            "2ccede54a4a5a04f",
            "85c51a301d79a3b0",
            "dc0a8d8472d69018",
            "d8846e0f63492e5c",
            "8c76afa0ac7889a5",
            "cbc189df5bfca31d",
            "548e41b7da4c5532",
            "ea7b563a11080719",
            "9163bec8860ad4f9",
            "7752b3837f5c9557",
            "9585c3ce74a4d1a1",
            "55640c5cfc5fcb66"
        ],
        "x": 34,
        "y": 3499,
        "w": 1312,
        "h": 282
    },
    {
        "id": "37721d011799f43a",
        "type": "group",
        "z": "3a056c2d95c24d79",
        "name": "Firebase Token Handler",
        "style": {
            "label": true
        },
        "nodes": [
            "0a207a4223822828",
            "105adace85471fc0",
            "fe6b5ae2588f8915",
            "54be08ef54c8720b"
        ],
        "x": 584,
        "y": 319,
        "w": 752,
        "h": 82
    },
    {
        "id": "4124681a5ccaaaf2",
        "type": "group",
        "z": "2751cff285e8ba2d",
        "name": "Firebase notification process",
        "style": {
            "label": true
        },
        "nodes": [
            "f1f33d90d871e986",
            "e2d44055a3b0e842"
        ],
        "x": 474,
        "y": 359,
        "w": 472,
        "h": 82
    },
    {
        "id": "19762fd47b742d3c",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Set Location",
        "style": {
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "42eaea6f2fbfb1e4",
            "f7237cf3043d6090",
            "4a3dd7bf7cbcc405",
            "aeac0f7ba5098724",
            "59b79324370ce600",
            "b662a3a1f6e7fec3",
            "25a30e09aab14018",
            "cd58d3bd7a4a4f5e",
            "2880cb275f1a652c",
            "f2961548194dc877",
            "6eeb14468afaed1f",
            "01e3a3cc433b1c59",
            "bb6ab39b15241f2d",
            "ac7791be6d092be9"
        ],
        "x": 34,
        "y": 4059,
        "w": 1312,
        "h": 202
    },
    {
        "id": "5b2449d89192a504",
        "type": "group",
        "z": "dd62ac133fb1360c",
        "name": "Location on map",
        "style": {
            "label": true
        },
        "nodes": [
            "a113a6d1a7a1ea63",
            "dc5aa2cfa5df5e61",
            "ed633ab67bec359b",
            "9bc749ad4f114060"
        ],
        "x": 314,
        "y": 1519,
        "w": 792,
        "h": 82
    },
    {
        "id": "fa50a94c7828706e",
        "type": "group",
        "z": "217d4457bda21c0d",
        "name": "Get Litres Per Second",
        "style": {
            "label": true
        },
        "nodes": [
            "11a7c9e7ad6fe7f2",
            "5b2c61639699e9bd",
            "4e2adf6367a314d3",
            "22c69011f164d339",
            "6eba11501d2c7ff8",
            "2a13828b9b195505",
            "2a7afbe0b1c488c5",
            "eb7830540f34e3ce",
            "4bf239c3a4a0de65",
            "d64a1cc371e281bb",
            "9704ef73f33b2c9c",
            "0173dbee92a8f9ea",
            "31a11d46097a68de",
            "3ef3e0aa69f76957",
            "87d2f74c18ab7d50",
            "64d4eb4301561a6c",
            "d0d8c28baef09709",
            "6143345bbc46fc25"
        ],
        "x": 34,
        "y": 3819,
        "w": 1312,
        "h": 202
    },
    {
        "id": "35a931a21e40509a",
        "type": "group",
        "z": "7af354fb2230bd6b",
        "name": "Update Total filtered for Redis",
        "style": {
            "label": true
        },
        "nodes": [
            "801ac7e0744b9782",
            "e6e04b436010c8f9",
            "04e7e283f60a887d",
            "d5aa805bcb588c36",
            "ada19a977d39bf9f"
        ],
        "x": 44,
        "y": 639,
        "w": 732,
        "h": 82
    },
    {
        "id": "c77abff0c3609a0d",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt://212.78.1.205",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "c1ceec1569757720",
        "type": "ui_tab",
        "name": "Objectives",
        "icon": "mi-emoji_events",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "c527304ede8acd9c",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "a6a64a541ae8c000",
        "type": "ui_group",
        "name": "Plastic saved",
        "tab": "ff083ec2093f4a2e",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "647f7f903ce97865",
        "type": "postgreSQLConfig",
        "name": "",
        "host": "DB_IP",
        "hostFieldType": "env",
        "port": "DB_PORT",
        "portFieldType": "env",
        "database": "jugdb",
        "databaseFieldType": "str",
        "ssl": "false",
        "sslFieldType": "bool",
        "applicationName": "",
        "applicationNameType": "str",
        "max": "10",
        "maxFieldType": "num",
        "idle": "1000",
        "idleFieldType": "num",
        "connectionTimeout": "10000",
        "connectionTimeoutFieldType": "num",
        "user": "nodered",
        "userFieldType": "str",
        "password": "passwordsegreta",
        "passwordFieldType": "str"
    },
    {
        "id": "ff083ec2093f4a2e",
        "type": "ui_tab",
        "name": "Dashboard",
        "icon": "mi-water_drop",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d1a0b3959db61542",
        "type": "ui_group",
        "name": "Water informations",
        "tab": "ff083ec2093f4a2e",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2dab9229986fd1ba",
        "type": "ui_group",
        "name": "Jugs Quantities",
        "tab": "ff083ec2093f4a2e",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f666e567f16cadaa",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt://test.mosquitto.org",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "12c2e9b2a697267d",
        "type": "ui_group",
        "name": "Alerts",
        "tab": "ff083ec2093f4a2e",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4bfb72e0581a07c0",
        "type": "ui_group",
        "name": "Users Information",
        "tab": "ff083ec2093f4a2e",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c27372d8e95188d1",
        "type": "ui_group",
        "name": "Plastic Obj",
        "tab": "c1ceec1569757720",
        "order": 6,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c73a3a9fe70498d5",
        "type": "ui_group",
        "name": "Jugs Obj",
        "tab": "c1ceec1569757720",
        "order": 4,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "cdbb240eb1898b91",
        "type": "ui_group",
        "name": "Users Obj",
        "tab": "c1ceec1569757720",
        "order": 5,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "df153d084656312d",
        "type": "redis-config",
        "name": "Redis",
        "options": "{\"host\":$env(\"REDIS_HOST\")}",
        "cluster": false,
        "optionsType": "jsonata"
    },
    {
        "id": "222522e409a8c70d",
        "type": "firebase admin",
        "name": "FB_Admin"
    },
    {
        "id": "5f9d14c098bf937f",
        "type": "ui_tab",
        "name": "Location",
        "icon": "gps_fixed",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "2315b68dc8088d18",
        "type": "ui_group",
        "name": "Jugs Location",
        "tab": "5f9d14c098bf937f",
        "order": 1,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8e7d846effd9e3d7",
        "type": "json",
        "z": "8ae59feea1fac0e6",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 170,
        "y": 80,
        "wires": [
            [
                "69cda81b0575d657"
            ]
        ]
    },
    {
        "id": "68a2107c3e0d91ed",
        "type": "switch",
        "z": "8ae59feea1fac0e6",
        "name": "Does user already exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "hask",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 950,
        "y": 140,
        "wires": [
            [],
            [
                "1ab4581e07bcb883"
            ]
        ]
    },
    {
        "id": "43ca287d27944fbd",
        "type": "postgresql",
        "z": "8ae59feea1fac0e6",
        "name": "Select User with provided email",
        "query": "SELECT * FROM UserTable WHERE email = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 710,
        "y": 80,
        "wires": [
            [
                "68a2107c3e0d91ed"
            ]
        ]
    },
    {
        "id": "69cda81b0575d657",
        "type": "change",
        "z": "8ae59feea1fac0e6",
        "name": "Extract email and save payload",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.payload.username]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "old",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 80,
        "wires": [
            [
                "43ca287d27944fbd"
            ]
        ]
    },
    {
        "id": "7837703e879a4a5c",
        "type": "change",
        "z": "8ae59feea1fac0e6",
        "name": "Prepare params (existent email and pw)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.old.username, msg.old.password]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "1ab4581e07bcb883",
        "type": "bcrypt",
        "z": "8ae59feea1fac0e6",
        "name": "Hash password",
        "action": "encrypt",
        "field": "old.password",
        "hash": "payload",
        "target": "payload",
        "assignment": "replace",
        "match": "match",
        "outputs": 1,
        "rounds": 10,
        "x": 780,
        "y": 220,
        "wires": [
            [
                "7837703e879a4a5c"
            ]
        ]
    },
    {
        "id": "344ec21cbcc27646",
        "type": "postgresql",
        "z": "3a056c2d95c24d79",
        "name": "Verify email",
        "query": "SELECT userId, password FROM UserTable WHERE email = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 650,
        "y": 80,
        "wires": [
            [
                "b04c2642611152ff"
            ]
        ]
    },
    {
        "id": "c9342c2ae65773a2",
        "type": "switch",
        "z": "3a056c2d95c24d79",
        "name": "Does User exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "hask",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 190,
        "y": 220,
        "wires": [
            [
                "b577747445569858"
            ],
            []
        ]
    },
    {
        "id": "68fcddddc6fb266a",
        "type": "json",
        "z": "3a056c2d95c24d79",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 150,
        "y": 80,
        "wires": [
            [
                "7e1954517d0b4ab3"
            ]
        ]
    },
    {
        "id": "7e1954517d0b4ab3",
        "type": "change",
        "z": "3a056c2d95c24d79",
        "name": "Prepare params (email) and save pw, token",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.payload.username]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "passedPw",
                "pt": "msg",
                "to": "payload.password",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "firebaseToken",
                "pt": "msg",
                "to": "payload.firebaseToken",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 80,
        "wires": [
            [
                "344ec21cbcc27646"
            ]
        ]
    },
    {
        "id": "346b27e6057f0e34",
        "type": "bcrypt",
        "z": "3a056c2d95c24d79",
        "name": "Compare passwords",
        "action": "verify",
        "field": "passedPw",
        "hash": "dbpw",
        "target": "payload",
        "assignment": "replace",
        "match": "match",
        "outputs": 2,
        "rounds": 10,
        "x": 620,
        "y": 200,
        "wires": [
            [
                "59c779ace80f7635"
            ],
            []
        ]
    },
    {
        "id": "b577747445569858",
        "type": "change",
        "z": "3a056c2d95c24d79",
        "name": "Set pw and userid",
        "rules": [
            {
                "t": "set",
                "p": "dbpw",
                "pt": "msg",
                "to": "payload[0].password",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "userId",
                "pt": "msg",
                "to": "payload[0].userid",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 200,
        "wires": [
            [
                "346b27e6057f0e34"
            ]
        ]
    },
    {
        "id": "eb01921b49e9b9ed",
        "type": "change",
        "z": "3a056c2d95c24d79",
        "name": "Set payload to userId",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"userid\": msg.userId}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "0a207a4223822828",
        "type": "change",
        "z": "3a056c2d95c24d79",
        "g": "37721d011799f43a",
        "name": "Prepare params (firebaseToken, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.firebaseToken, msg.userId]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 860,
        "y": 360,
        "wires": [
            [
                "105adace85471fc0"
            ]
        ]
    },
    {
        "id": "105adace85471fc0",
        "type": "postgresql",
        "z": "3a056c2d95c24d79",
        "g": "37721d011799f43a",
        "name": "Register firebaseToken",
        "query": "INSERT INTO FirebaseTokens VALUES ($1, $2)\nON CONFLICT (token) DO NOTHING;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1140,
        "y": 360,
        "wires": [
            [
                "54be08ef54c8720b"
            ]
        ]
    },
    {
        "id": "59c779ace80f7635",
        "type": "switch",
        "z": "3a056c2d95c24d79",
        "name": "Is token undefined?",
        "property": "firebaseToken",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "undefined",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 850,
        "y": 180,
        "wires": [
            [
                "eb01921b49e9b9ed"
            ],
            [
                "5d5894e60dda010b"
            ]
        ]
    },
    {
        "id": "b04c2642611152ff",
        "type": "link out",
        "z": "3a056c2d95c24d79",
        "name": "link out 21",
        "mode": "link",
        "links": [
            "2369ea38a30c8949"
        ],
        "x": 765,
        "y": 80,
        "wires": []
    },
    {
        "id": "2369ea38a30c8949",
        "type": "link in",
        "z": "3a056c2d95c24d79",
        "name": "link in 23",
        "links": [
            "b04c2642611152ff"
        ],
        "x": 65,
        "y": 220,
        "wires": [
            [
                "c9342c2ae65773a2"
            ]
        ]
    },
    {
        "id": "5d5894e60dda010b",
        "type": "link out",
        "z": "3a056c2d95c24d79",
        "name": "link out 22",
        "mode": "link",
        "links": [
            "fe6b5ae2588f8915"
        ],
        "x": 945,
        "y": 240,
        "wires": []
    },
    {
        "id": "fe6b5ae2588f8915",
        "type": "link in",
        "z": "3a056c2d95c24d79",
        "g": "37721d011799f43a",
        "name": "link in 24",
        "links": [
            "5d5894e60dda010b"
        ],
        "x": 625,
        "y": 360,
        "wires": [
            [
                "0a207a4223822828"
            ]
        ]
    },
    {
        "id": "54be08ef54c8720b",
        "type": "link out",
        "z": "3a056c2d95c24d79",
        "g": "37721d011799f43a",
        "name": "link out 23",
        "mode": "link",
        "links": [
            "1ac30b54ad114966"
        ],
        "x": 1295,
        "y": 360,
        "wires": []
    },
    {
        "id": "1ac30b54ad114966",
        "type": "link in",
        "z": "3a056c2d95c24d79",
        "name": "link in 25",
        "links": [
            "54be08ef54c8720b"
        ],
        "x": 1005,
        "y": 240,
        "wires": [
            [
                "eb01921b49e9b9ed"
            ]
        ]
    },
    {
        "id": "ce16f9573b804d91",
        "type": "http request",
        "z": "b6b33a23690f53f3",
        "g": "d0158497c3f88bb8",
        "name": "Create Thing",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Resources/EntityServices/Services/CreateThing",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 390,
        "y": 240,
        "wires": [
            [
                "5abf18101812be96"
            ]
        ]
    },
    {
        "id": "90af0b5592d2b50b",
        "type": "function",
        "z": "b6b33a23690f53f3",
        "name": "Craft success message on condition",
        "func": "if (msg.payload == \"\"){\n    msg.payload = \"Thing addition request completed.\"\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1090,
        "y": 240,
        "wires": [
            [
                "4818a8ee8ce9699e"
            ]
        ]
    },
    {
        "id": "6f1e5e7364d80697",
        "type": "http request",
        "z": "b6b33a23690f53f3",
        "g": "d0158497c3f88bb8",
        "name": "Enable Thing",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jugid}}/Services/EnableThing",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 610,
        "y": 240,
        "wires": [
            [
                "12d7faae89458ea7"
            ]
        ]
    },
    {
        "id": "12d7faae89458ea7",
        "type": "http request",
        "z": "b6b33a23690f53f3",
        "g": "d0158497c3f88bb8",
        "name": "Restart Thing",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jugid}}/Services/RestartThing",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 800,
        "y": 240,
        "wires": [
            [
                "90af0b5592d2b50b"
            ]
        ]
    },
    {
        "id": "5abf18101812be96",
        "type": "delay",
        "z": "b6b33a23690f53f3",
        "g": "d0158497c3f88bb8",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 500,
        "y": 300,
        "wires": [
            [
                "6f1e5e7364d80697",
                "281461b3d1958110"
            ]
        ]
    },
    {
        "id": "c4bdcc33cbf74d3f",
        "type": "function",
        "z": "b6b33a23690f53f3",
        "name": "Create HTTP Body with Thing name, projectName and Template",
        "func": "msg.payload = {\"name\": `Jug${msg.jugid}`, \"projectName\": \"cattaneo-isola\", \"thingTemplateName\": \"JugTemplate\" };\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 100,
        "wires": [
            [
                "89435c690d0590a0"
            ]
        ]
    },
    {
        "id": "89435c690d0590a0",
        "type": "link out",
        "z": "b6b33a23690f53f3",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "77644a81e9d05044"
        ],
        "x": 925,
        "y": 100,
        "wires": []
    },
    {
        "id": "77644a81e9d05044",
        "type": "link in",
        "z": "b6b33a23690f53f3",
        "name": "link in 1",
        "links": [
            "89435c690d0590a0"
        ],
        "x": 205,
        "y": 240,
        "wires": [
            [
                "ce16f9573b804d91"
            ]
        ]
    },
    {
        "id": "505ccfe324b1de17",
        "type": "comment",
        "z": "b6b33a23690f53f3",
        "g": "d0158497c3f88bb8",
        "name": "The flow is Creation, Enabling, Restarting necessary to make the thing work",
        "info": "",
        "x": 600,
        "y": 200,
        "wires": []
    },
    {
        "id": "4818a8ee8ce9699e",
        "type": "debug",
        "z": "b6b33a23690f53f3",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1250,
        "y": 300,
        "wires": []
    },
    {
        "id": "281461b3d1958110",
        "type": "debug",
        "z": "b6b33a23690f53f3",
        "name": "debug 26",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1040,
        "y": 160,
        "wires": []
    },
    {
        "id": "17a95012080ff363",
        "type": "postgresql",
        "z": "98b9aea3ec541c1d",
        "name": "Insert or Update Jug",
        "query": "INSERT INTO JugTable(id,userId,filterCapacity,name,lat,lon) VALUES ($1, $2, 0, $3, null, null)\nON CONFLICT (id) DO UPDATE\n    SET userId = $2;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 620,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "111121c67e0c3d75",
        "type": "change",
        "z": "98b9aea3ec541c1d",
        "name": "Prepare params (jugId, userId, jugName)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jugid, msg.token.userid, msg.payload.jugname]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 80,
        "wires": [
            [
                "17a95012080ff363"
            ]
        ]
    },
    {
        "id": "08d1b59a62811f23",
        "type": "http request",
        "z": "3642f44d746371ee",
        "name": "Update Filter Capacity (ThingWorx)",
        "method": "PUT",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jug}}/Properties/filterCapacity",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 1240,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "45d1266ff6761abe",
        "type": "postgresql",
        "z": "3642f44d746371ee",
        "name": "Update Filter Capacity (DB)",
        "query": "UPDATE JugTable SET filterCapacity = $2, notified = false WHERE id = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 740,
        "y": 160,
        "wires": [
            [
                "8a11ea59c3f8d60a"
            ]
        ]
    },
    {
        "id": "b6b4dc96767b01fb",
        "type": "change",
        "z": "3642f44d746371ee",
        "name": "Prepare params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.jugId",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "filter",
                "pt": "msg",
                "to": "payload.filter",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 80,
        "wires": [
            [
                "02f64a78628a2d24"
            ]
        ]
    },
    {
        "id": "8a11ea59c3f8d60a",
        "type": "change",
        "z": "3642f44d746371ee",
        "name": "Set filterCapacity",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{ \"filterCapacity\": msg.filter}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 990,
        "y": 160,
        "wires": [
            [
                "08d1b59a62811f23",
                "9805503f4874d425"
            ]
        ]
    },
    {
        "id": "9805503f4874d425",
        "type": "json",
        "z": "3642f44d746371ee",
        "name": "to json",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 1170,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "02f64a78628a2d24",
        "type": "subflow:e6c0f715714d0f23",
        "z": "3642f44d746371ee",
        "name": "",
        "x": 470,
        "y": 80,
        "wires": [
            [
                "835fc3041479b855"
            ]
        ]
    },
    {
        "id": "835fc3041479b855",
        "type": "change",
        "z": "3642f44d746371ee",
        "name": "Prepare params (jugId, filterCapacity)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.filter]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 160,
        "wires": [
            [
                "45d1266ff6761abe"
            ]
        ]
    },
    {
        "id": "325c4faa337cc671",
        "type": "postgresql",
        "z": "fa232f5df39eb96b",
        "name": "Get Jug ids from DB",
        "query": "SELECT id FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 240,
        "y": 80,
        "wires": [
            [
                "24edee6879b68938"
            ]
        ]
    },
    {
        "id": "24edee6879b68938",
        "type": "split",
        "z": "fa232f5df39eb96b",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 430,
        "y": 80,
        "wires": [
            [
                "d824589b06d07a80"
            ]
        ]
    },
    {
        "id": "d824589b06d07a80",
        "type": "function",
        "z": "fa232f5df39eb96b",
        "name": "Construct Jug Definition (name, projectName, Template)",
        "func": "msg.payload = {\"name\": \"Jug\" + msg.payload.id,  \"projectName\":\"cattaneo-isola\", \"thingTemplateName\": \"JugTemplate\" }\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 80,
        "wires": [
            [
                "de0bdc66b84eb42b"
            ]
        ]
    },
    {
        "id": "de0bdc66b84eb42b",
        "type": "debug",
        "z": "fa232f5df39eb96b",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 60,
        "wires": []
    },
    {
        "id": "f1a90bc89958c9af",
        "type": "bcrypt",
        "z": "bf3376f998e1b263",
        "name": "Hash password",
        "action": "verify",
        "field": "oldPw",
        "hash": "payload",
        "target": "payload",
        "assignment": "replace",
        "match": "match",
        "outputs": 2,
        "rounds": 10,
        "x": 940,
        "y": 80,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "7a97413dbf01a821",
        "type": "postgresql",
        "z": "bf3376f998e1b263",
        "name": "Select User with provided id",
        "query": "SELECT password FROM UserTable WHERE userId = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 480,
        "y": 80,
        "wires": [
            [
                "e033653036140580"
            ]
        ]
    },
    {
        "id": "c381f2a70245441b",
        "type": "change",
        "z": "bf3376f998e1b263",
        "name": "Prepare params (userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 80,
        "wires": [
            [
                "7a97413dbf01a821"
            ]
        ]
    },
    {
        "id": "e033653036140580",
        "type": "change",
        "z": "bf3376f998e1b263",
        "name": "Set payload to password",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].password",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 80,
        "wires": [
            [
                "f1a90bc89958c9af"
            ]
        ]
    },
    {
        "id": "a28cd932aa8b670a",
        "type": "postgresql",
        "z": "e6c0f715714d0f23",
        "g": "ef04f78fe84031f4",
        "name": "Check if user owns the jug",
        "query": "SELECT userId FROM JugTable WHERE id = $1 AND userId = $2;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 280,
        "y": 140,
        "wires": [
            [
                "c04b38ae73eb9b2d"
            ]
        ]
    },
    {
        "id": "c04b38ae73eb9b2d",
        "type": "switch",
        "z": "e6c0f715714d0f23",
        "g": "ef04f78fe84031f4",
        "name": "Is the owner?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "hask",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 500,
        "y": 140,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "e617a36252101d98",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Registration",
        "url": "/register",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 120,
        "wires": [
            [
                "c80edb6648fb5c23"
            ]
        ]
    },
    {
        "id": "9f2b775c5e24acb8",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Insert email, pw",
        "query": "INSERT INTO UserTable(email, password) VALUES ($1, $2);",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 800,
        "y": 100,
        "wires": [
            [
                "10b809801dba4bcb"
            ]
        ]
    },
    {
        "id": "10b809801dba4bcb",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1180,
        "y": 100,
        "wires": []
    },
    {
        "id": "5c3d7fd931d482a9",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Login",
        "url": "/login",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 420,
        "wires": [
            [
                "594f99b964435f02"
            ]
        ]
    },
    {
        "id": "4f6f6fac724a496a",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1180,
        "y": 480,
        "wires": []
    },
    {
        "id": "7b80c134f08a63b6",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "to json",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 1010,
        "y": 420,
        "wires": [
            [
                "4f6f6fac724a496a"
            ]
        ]
    },
    {
        "id": "f5c3aee0864a46be",
        "type": "mqtt in",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "",
        "topic": "/jug/pair",
        "qos": "0",
        "datatype": "json",
        "broker": "c77abff0c3609a0d",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 760,
        "wires": [
            [
                "fa470500be985961"
            ]
        ]
    },
    {
        "id": "378b9baed000b7e6",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 530,
        "y": 760,
        "wires": [
            [
                "a55abe65144b7b0c",
                "9935b7fb6f9babfb"
            ]
        ]
    },
    {
        "id": "6737c839da4aeeab",
        "type": "jwt sign",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "JWT Sign of userId",
        "alg": "HS256",
        "exp": "31536000000",
        "jwkurl": "",
        "jwkkid": "",
        "secret": "secret",
        "key": "",
        "signvar": "payload",
        "storetoken": "token",
        "x": 550,
        "y": 420,
        "wires": [
            [
                "516f8568ef9efb35"
            ]
        ]
    },
    {
        "id": "c80edb6648fb5c23",
        "type": "subflow:8ae59feea1fac0e6",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "",
        "x": 360,
        "y": 120,
        "wires": [
            [
                "9f2b775c5e24acb8"
            ],
            [
                "a9f71d3d32f804d1"
            ]
        ]
    },
    {
        "id": "594f99b964435f02",
        "type": "subflow:3a056c2d95c24d79",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "",
        "x": 310,
        "y": 420,
        "wires": [
            [
                "6737c839da4aeeab"
            ],
            [
                "3694c41146d5c40c"
            ]
        ]
    },
    {
        "id": "99c1e01bcdde1e9a",
        "type": "mqtt out",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "",
        "topic": "/jug/pair/response",
        "qos": "0",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "c77abff0c3609a0d",
        "x": 1170,
        "y": 760,
        "wires": []
    },
    {
        "id": "a22ecd30043c6866",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "Update Filter",
        "url": "/filter",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 940,
        "wires": [
            [
                "7fe99103bea3c313"
            ]
        ]
    },
    {
        "id": "3045dac9484f5175",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1180,
        "y": 940,
        "wires": []
    },
    {
        "id": "86072dca8a4675b9",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 690,
        "y": 940,
        "wires": [
            [
                "15a4b9f0df755521"
            ]
        ]
    },
    {
        "id": "7fe99103bea3c313",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 270,
        "y": 940,
        "wires": [
            [
                "8962bee34f1ecb3d"
            ]
        ]
    },
    {
        "id": "a55abe65144b7b0c",
        "type": "subflow:b6b33a23690f53f3",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "x": 770,
        "y": 820,
        "wires": []
    },
    {
        "id": "dcd2b471dd5d1d54",
        "type": "subflow:98b9aea3ec541c1d",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "",
        "x": 970,
        "y": 760,
        "wires": [
            [
                "99c1e01bcdde1e9a"
            ]
        ]
    },
    {
        "id": "15a4b9f0df755521",
        "type": "subflow:3642f44d746371ee",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "",
        "x": 930,
        "y": 940,
        "wires": [
            [
                "3045dac9484f5175"
            ]
        ]
    },
    {
        "id": "0e902976e72968fd",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Change email",
        "url": "/email",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 1140,
        "wires": [
            [
                "38ba2f89ca333620"
            ]
        ]
    },
    {
        "id": "419b5ed523e9346f",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1180,
        "y": 1140,
        "wires": []
    },
    {
        "id": "972ae2bb601df8f1",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Update User Email",
        "query": "UPDATE UserTable SET email = $2 WHERE userId = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 930,
        "y": 1140,
        "wires": [
            [
                "419b5ed523e9346f"
            ]
        ]
    },
    {
        "id": "52c86537f1269879",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Change password",
        "url": "/pw",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1340,
        "wires": [
            [
                "b235729f20069b7d"
            ]
        ]
    },
    {
        "id": "181a7d2e9fcd4401",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 1420,
        "wires": []
    },
    {
        "id": "56503f67950889f9",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Update User Password",
        "query": "UPDATE UserTable SET password = $2 WHERE userId = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1170,
        "y": 1340,
        "wires": [
            [
                "181a7d2e9fcd4401"
            ]
        ]
    },
    {
        "id": "2a9796619308d20a",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Delete account",
        "url": "/deleteAccount",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 1620,
        "wires": [
            [
                "357366d052222e44"
            ]
        ]
    },
    {
        "id": "98bdb442331f9b81",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 1620,
        "wires": []
    },
    {
        "id": "0e21d86ce0178699",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Delete Account",
        "query": "DELETE FROM UserTable WHERE userId = $1",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1020,
        "y": 1620,
        "wires": [
            [
                "98bdb442331f9b81"
            ]
        ]
    },
    {
        "id": "e9961cce33071acc",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Set params (userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1620,
        "wires": [
            [
                "0e21d86ce0178699"
            ]
        ]
    },
    {
        "id": "fa470500be985961",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Extract jugId and Token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jugid",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 310,
        "y": 760,
        "wires": [
            [
                "378b9baed000b7e6"
            ]
        ]
    },
    {
        "id": "da290a44a03ac8ee",
        "type": "comment",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "If user doesn't exists, insert into DB, otherwise respond back with provided credentials",
        "info": "",
        "x": 620,
        "y": 60,
        "wires": []
    },
    {
        "id": "a4b68c47b965d3f2",
        "type": "comment",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Verify credentials for login, create an unique JWT Token to identify user when pair jug",
        "info": "",
        "x": 670,
        "y": 340,
        "wires": []
    },
    {
        "id": "8962bee34f1ecb3d",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "Extract id, token, filterCapacity",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "filter",
                "pt": "msg",
                "to": "payload.filterCapacity",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 940,
        "wires": [
            [
                "86072dca8a4675b9"
            ]
        ]
    },
    {
        "id": "f886d4659e9bc7b2",
        "type": "catch",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "DB Catch",
        "scope": [
            "9f2b775c5e24acb8",
            "972ae2bb601df8f1",
            "56503f67950889f9",
            "0e21d86ce0178699",
            "83c99c7142a96e7f",
            "d0c5bf7405388a7c",
            "28705e872a39bf64",
            "4810de2e5fcc3538",
            "dfa5ae5d5416ad40",
            "ec9eb5085c4a8fe1",
            "cda6c2362dcb7726"
        ],
        "uncaught": false,
        "x": 120,
        "y": 4580,
        "wires": [
            [
                "aed1bb2bfb8d429a"
            ]
        ]
    },
    {
        "id": "3e6ab8f278a930ef",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Registration Completition",
        "scope": [
            "9f2b775c5e24acb8"
        ],
        "uncaught": false,
        "x": 170,
        "y": 180,
        "wires": [
            [
                "6addd85ab87497c3"
            ]
        ]
    },
    {
        "id": "c2d7c74e09b2e312",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 200,
        "wires": []
    },
    {
        "id": "2c0f67140fd1b413",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Login Completition",
        "scope": [
            "516f8568ef9efb35"
        ],
        "uncaught": false,
        "x": 150,
        "y": 520,
        "wires": [
            [
                "40ce6893f6966a45"
            ]
        ]
    },
    {
        "id": "06749a30d3205d94",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "Update Filter Completition",
        "scope": [
            "3045dac9484f5175"
        ],
        "uncaught": false,
        "x": 170,
        "y": 1020,
        "wires": [
            [
                "841f478027e2f418"
            ]
        ]
    },
    {
        "id": "91f42fd977778f76",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Change Email Completition",
        "scope": [
            "419b5ed523e9346f"
        ],
        "uncaught": false,
        "x": 170,
        "y": 1220,
        "wires": [
            [
                "8e2288be6eecf071"
            ]
        ]
    },
    {
        "id": "035d90da9f82f6ee",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Change Password Completition",
        "scope": [
            "56503f67950889f9"
        ],
        "uncaught": false,
        "x": 190,
        "y": 1460,
        "wires": [
            [
                "9b2e1ee643f77b0a"
            ]
        ]
    },
    {
        "id": "7863615649b984e9",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Account Deletion Completition",
        "scope": [
            "98bdb442331f9b81"
        ],
        "uncaught": false,
        "x": 180,
        "y": 1700,
        "wires": [
            [
                "02dfd341a8807e9a"
            ]
        ]
    },
    {
        "id": "3c434ec046f71a23",
        "type": "inject",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 4340,
        "wires": [
            [
                "83c99c7142a96e7f"
            ]
        ]
    },
    {
        "id": "83c99c7142a96e7f",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "Show USER table",
        "query": "SELECT * FROM UserTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 350,
        "y": 4340,
        "wires": [
            [
                "367f5704e274bbf0"
            ]
        ]
    },
    {
        "id": "5898347def636b4d",
        "type": "inject",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 4400,
        "wires": [
            [
                "d0c5bf7405388a7c"
            ]
        ]
    },
    {
        "id": "d0c5bf7405388a7c",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "Clean USER table",
        "query": "DELETE FROM UserTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 350,
        "y": 4400,
        "wires": [
            [
                "c98c52a08de3b558"
            ]
        ]
    },
    {
        "id": "c98c52a08de3b558",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 4400,
        "wires": []
    },
    {
        "id": "801868f4cc631259",
        "type": "inject",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 820,
        "y": 4340,
        "wires": [
            [
                "28705e872a39bf64"
            ]
        ]
    },
    {
        "id": "28705e872a39bf64",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "Show  JUG table",
        "query": "SELECT * FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1040,
        "y": 4340,
        "wires": [
            [
                "1cd3cb4c7a6a6292"
            ]
        ]
    },
    {
        "id": "1cd3cb4c7a6a6292",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "debug 7",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1240,
        "y": 4340,
        "wires": []
    },
    {
        "id": "f8e038c0ae26a12a",
        "type": "inject",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 820,
        "y": 4460,
        "wires": [
            [
                "4810de2e5fcc3538"
            ]
        ]
    },
    {
        "id": "4810de2e5fcc3538",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "Clean JUG table",
        "query": "DELETE FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1040,
        "y": 4460,
        "wires": [
            [
                "bad79e1fd1d22d16"
            ]
        ]
    },
    {
        "id": "bad79e1fd1d22d16",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "2014e345587e4007",
        "name": "debug 8",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1240,
        "y": 4460,
        "wires": []
    },
    {
        "id": "70e3419b45428f51",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Pair Completition",
        "scope": [
            "99c1e01bcdde1e9a"
        ],
        "uncaught": false,
        "x": 140,
        "y": 820,
        "wires": [
            [
                "581e57b5ed15ddce"
            ]
        ]
    },
    {
        "id": "6addd85ab87497c3",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Registration Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 180,
        "wires": [
            [
                "c2d7c74e09b2e312"
            ]
        ]
    },
    {
        "id": "40ce6893f6966a45",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Login Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 520,
        "wires": [
            [
                "339436e98d838faf"
            ]
        ]
    },
    {
        "id": "339436e98d838faf",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 580,
        "wires": []
    },
    {
        "id": "581e57b5ed15ddce",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Pairing Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 820,
        "wires": [
            [
                "b79303726be56dc6"
            ]
        ]
    },
    {
        "id": "b79303726be56dc6",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 820,
        "wires": []
    },
    {
        "id": "841f478027e2f418",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Filter Update Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1020,
        "wires": [
            [
                "28d97bfdb5c2a53a"
            ]
        ]
    },
    {
        "id": "28d97bfdb5c2a53a",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "20496de9b60de6a8",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 1020,
        "wires": []
    },
    {
        "id": "8e2288be6eecf071",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Email Change Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 1220,
        "wires": [
            [
                "85468fb5347ae2b0"
            ]
        ]
    },
    {
        "id": "85468fb5347ae2b0",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 1220,
        "wires": []
    },
    {
        "id": "9b2e1ee643f77b0a",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Password Change Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 1460,
        "wires": [
            [
                "dda3f2e8d089d3b3"
            ]
        ]
    },
    {
        "id": "dda3f2e8d089d3b3",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1500,
        "wires": []
    },
    {
        "id": "02dfd341a8807e9a",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Account Deletion Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1700,
        "wires": [
            [
                "185774d4d094bfe0"
            ]
        ]
    },
    {
        "id": "185774d4d094bfe0",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 1700,
        "wires": []
    },
    {
        "id": "27ad1b042019570d",
        "type": "comment",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Jug sends pair request to add itself, with the user who requested, to the DB and ThingWorx",
        "info": "",
        "x": 650,
        "y": 720,
        "wires": []
    },
    {
        "id": "c7d12a04bb0c7cc3",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Get Jugs",
        "url": "/getJugs",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 2020,
        "wires": [
            [
                "9cd4aacb75e41236"
            ]
        ]
    },
    {
        "id": "98f18f7a7a288504",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 2120,
        "wires": []
    },
    {
        "id": "1cfcbe763e4966cd",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "to json",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 1090,
        "y": 2120,
        "wires": [
            [
                "98f18f7a7a288504"
            ]
        ]
    },
    {
        "id": "ec9eb5085c4a8fe1",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Get Jugs from Account",
        "query": "SELECT * FROM JugTable WHERE userId = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1020,
        "y": 2060,
        "wires": [
            [
                "d9e203587f3d77f1"
            ]
        ]
    },
    {
        "id": "d9e203587f3d77f1",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Return Jug List",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"jugs\":msg.payload}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 2060,
        "wires": [
            [
                "1cfcbe763e4966cd"
            ]
        ]
    },
    {
        "id": "0f8de66e8416d0a1",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Get Jugs Completition",
        "scope": [
            "98f18f7a7a288504"
        ],
        "uncaught": false,
        "x": 160,
        "y": 2080,
        "wires": [
            [
                "ca273c111a09dc87"
            ]
        ]
    },
    {
        "id": "ca273c111a09dc87",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Jugs Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 2080,
        "wires": [
            [
                "7603bf0f721ecf7a"
            ]
        ]
    },
    {
        "id": "7603bf0f721ecf7a",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 2080,
        "wires": []
    },
    {
        "id": "9cd4aacb75e41236",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 270,
        "y": 2020,
        "wires": [
            [
                "9034a056bc11e4cd"
            ]
        ]
    },
    {
        "id": "9034a056bc11e4cd",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Extract token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 2020,
        "wires": [
            [
                "3fc7f576baa8f340"
            ]
        ]
    },
    {
        "id": "3fc7f576baa8f340",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 570,
        "y": 2020,
        "wires": [
            [
                "8e020c02f1d5bca5"
            ]
        ]
    },
    {
        "id": "8e020c02f1d5bca5",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Set params (userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 2020,
        "wires": [
            [
                "ec9eb5085c4a8fe1",
                "63e674961c23831c"
            ]
        ]
    },
    {
        "id": "98c6aa8214050734",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Response Error",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 4640,
        "wires": []
    },
    {
        "id": "d60a99a7a42e13aa",
        "type": "catch",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Catch All",
        "scope": null,
        "uncaught": true,
        "x": 120,
        "y": 4660,
        "wires": [
            [
                "aed1bb2bfb8d429a"
            ]
        ]
    },
    {
        "id": "e978e5b480cfcf05",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Delete Jug",
        "url": "/deleteJug",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 2240,
        "wires": [
            [
                "2bb3eaec03c0dc95"
            ]
        ]
    },
    {
        "id": "29bf6d8e0cfbd548",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 2300,
        "wires": []
    },
    {
        "id": "2c01cab46f92f6bc",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "to json",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 1050,
        "y": 2300,
        "wires": [
            [
                "29bf6d8e0cfbd548"
            ]
        ]
    },
    {
        "id": "dfa5ae5d5416ad40",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Delete Jug from Account",
        "query": "DELETE FROM JugTable WHERE id = $1 AND userId = $2;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1050,
        "y": 2240,
        "wires": [
            [
                "2c01cab46f92f6bc"
            ]
        ]
    },
    {
        "id": "97a10cbacf03277e",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Delete Jug Completition",
        "scope": [
            "29bf6d8e0cfbd548"
        ],
        "uncaught": false,
        "x": 160,
        "y": 2300,
        "wires": [
            [
                "aa8199b9c92b6b43"
            ]
        ]
    },
    {
        "id": "aa8199b9c92b6b43",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Jug Deletion Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 2300,
        "wires": [
            [
                "30f9c95a1522a625"
            ]
        ]
    },
    {
        "id": "30f9c95a1522a625",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 2300,
        "wires": []
    },
    {
        "id": "2bb3eaec03c0dc95",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 250,
        "y": 2240,
        "wires": [
            [
                "574a4b59ef9c857c"
            ]
        ]
    },
    {
        "id": "574a4b59ef9c857c",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 2240,
        "wires": [
            [
                "12f171e5e2f97465"
            ]
        ]
    },
    {
        "id": "12f171e5e2f97465",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 570,
        "y": 2240,
        "wires": [
            [
                "739fe77fb6b1077a"
            ]
        ]
    },
    {
        "id": "739fe77fb6b1077a",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "24db0ec2768119c9",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 2240,
        "wires": [
            [
                "dfa5ae5d5416ad40"
            ]
        ]
    },
    {
        "id": "2066612c8c9eee2a",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Rename Jugs",
        "url": "/renameJug",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 1820,
        "wires": [
            [
                "04498a2c6e846273"
            ]
        ]
    },
    {
        "id": "d600bb276f59c790",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 1880,
        "wires": []
    },
    {
        "id": "ecc2bae2ea58566d",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "to json",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 1070,
        "y": 1880,
        "wires": [
            [
                "d600bb276f59c790"
            ]
        ]
    },
    {
        "id": "cda6c2362dcb7726",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Rename Jug from Account",
        "query": "UPDATE JugTable SET name = $2 WHERE id = $1 AND userId = $3;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 1160,
        "y": 1820,
        "wires": [
            [
                "ecc2bae2ea58566d"
            ]
        ]
    },
    {
        "id": "d19accf56a5f8b81",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Rename Jug Completition",
        "scope": [
            "d600bb276f59c790"
        ],
        "uncaught": false,
        "x": 170,
        "y": 1880,
        "wires": [
            [
                "6dd0e3ed1b81fb3f"
            ]
        ]
    },
    {
        "id": "6dd0e3ed1b81fb3f",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Rename Jug Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1880,
        "wires": [
            [
                "47a6f97b12ee7513"
            ]
        ]
    },
    {
        "id": "47a6f97b12ee7513",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Print result",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 1880,
        "wires": []
    },
    {
        "id": "04498a2c6e846273",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 270,
        "y": 1820,
        "wires": [
            [
                "4f141f46c11c181f"
            ]
        ]
    },
    {
        "id": "4f141f46c11c181f",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Extract id, jugName, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "name",
                "pt": "msg",
                "to": "payload.name",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1820,
        "wires": [
            [
                "47e2ea0a595f5919"
            ]
        ]
    },
    {
        "id": "47e2ea0a595f5919",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 670,
        "y": 1820,
        "wires": [
            [
                "5179787add360544"
            ]
        ]
    },
    {
        "id": "5179787add360544",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "b1b492ef5f16e6c1",
        "name": "Set params (id, name, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.name, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 1820,
        "wires": [
            [
                "cda6c2362dcb7726"
            ]
        ]
    },
    {
        "id": "516f8568ef9efb35",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Return Set Token and UserId ",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{ \"token\": msg.token, \"userId\": msg.userId}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 420,
        "wires": [
            [
                "7b80c134f08a63b6"
            ]
        ]
    },
    {
        "id": "5b06d76a9679e1cb",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 1620,
        "wires": [
            [
                "e9961cce33071acc"
            ]
        ]
    },
    {
        "id": "a7d0411b8d68b5a1",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "Extract token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1620,
        "wires": [
            [
                "5b06d76a9679e1cb"
            ]
        ]
    },
    {
        "id": "fd8dcfa9337350f6",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Craft Return Status \"SERVER_ERROR\" (500)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 4640,
        "wires": [
            [
                "98c6aa8214050734"
            ]
        ]
    },
    {
        "id": "366863cb4e5f7bf2",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Craft Return Status \"Forbidden\" (403)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "403",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 990,
        "y": 1460,
        "wires": [
            [
                "181a7d2e9fcd4401"
            ]
        ]
    },
    {
        "id": "b4bc44fd8fd0d81f",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Print error msg (API)",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "error.message",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 4600,
        "wires": []
    },
    {
        "id": "fb45f15a6ea25bf8",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Set params (userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.token.userid, msg.newPw]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 940,
        "y": 1340,
        "wires": [
            [
                "56503f67950889f9"
            ]
        ]
    },
    {
        "id": "5e97cee8836acfbc",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Set params (userId, newEmail)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.token.userid, msg.newEmail]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 1140,
        "wires": [
            [
                "972ae2bb601df8f1"
            ]
        ]
    },
    {
        "id": "c243a77177af6c13",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 450,
        "y": 1140,
        "wires": [
            [
                "5e97cee8836acfbc"
            ]
        ]
    },
    {
        "id": "38ba2f89ca333620",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "f78c38617ed627c9",
        "name": "Extract token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "newEmail",
                "pt": "msg",
                "to": "payload.newEmail",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 1140,
        "wires": [
            [
                "c243a77177af6c13"
            ]
        ]
    },
    {
        "id": "e4316e93ff7c043c",
        "type": "subflow:bf3376f998e1b263",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "",
        "x": 740,
        "y": 1400,
        "wires": [
            [
                "fb7710509a9b6ed8"
            ],
            [
                "366863cb4e5f7bf2"
            ]
        ]
    },
    {
        "id": "893577be1c16039b",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 530,
        "y": 1400,
        "wires": [
            [
                "e4316e93ff7c043c"
            ]
        ]
    },
    {
        "id": "96074f98dd6204c8",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Extract token, newPw",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "oldPw",
                "pt": "msg",
                "to": "payload.oldPw",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "newPw",
                "pt": "msg",
                "to": "payload.newPw",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 1340,
        "wires": [
            [
                "893577be1c16039b"
            ]
        ]
    },
    {
        "id": "3694c41146d5c40c",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Craft Return Status \"Forbidden\" (403)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "403",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 480,
        "wires": [
            [
                "4f6f6fac724a496a"
            ]
        ]
    },
    {
        "id": "c6ca80c6a903e7ac",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Login Fail (401)",
        "scope": [
            "e5fcae23931eaf27"
        ],
        "uncaught": false,
        "x": 140,
        "y": 560,
        "wires": [
            [
                "336698c71763f8d9"
            ]
        ]
    },
    {
        "id": "336698c71763f8d9",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Craft msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Login Fail: User does not exists (401)",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 560,
        "wires": [
            [
                "339436e98d838faf"
            ]
        ]
    },
    {
        "id": "7b7a4bdf6c1331b2",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Login Fail (403)",
        "scope": [
            "3694c41146d5c40c"
        ],
        "uncaught": false,
        "x": 140,
        "y": 600,
        "wires": [
            [
                "1af63daa2efef9de"
            ]
        ]
    },
    {
        "id": "1af63daa2efef9de",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "cb681741da812fc7",
        "name": "Craft msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Login Fail: User Forbidden (403)",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 600,
        "wires": [
            [
                "339436e98d838faf"
            ]
        ]
    },
    {
        "id": "0f30d5fb290b42b3",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Change Password Fail",
        "scope": [
            "366863cb4e5f7bf2"
        ],
        "uncaught": false,
        "x": 160,
        "y": 1500,
        "wires": [
            [
                "18c0792f01784136"
            ]
        ]
    },
    {
        "id": "18c0792f01784136",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Craft msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Password Change Fail: User Forbidden (403)",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 1500,
        "wires": [
            [
                "dda3f2e8d089d3b3"
            ]
        ]
    },
    {
        "id": "a9f71d3d32f804d1",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Craft Return Status \"User already present\" (409)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "409",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 160,
        "wires": [
            [
                "10b809801dba4bcb"
            ]
        ]
    },
    {
        "id": "7bc253d919b1346f",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Registration Fail",
        "scope": [
            "a9f71d3d32f804d1"
        ],
        "uncaught": false,
        "x": 140,
        "y": 220,
        "wires": [
            [
                "a71d36987d32f7d6"
            ]
        ]
    },
    {
        "id": "a71d36987d32f7d6",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "bdbaa79edcd82992",
        "name": "Craft msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Registration Fail: User already present (409)",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 220,
        "wires": [
            [
                "c2d7c74e09b2e312"
            ]
        ]
    },
    {
        "id": "357366d052222e44",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "85cf4f26a7c39064",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 310,
        "y": 1620,
        "wires": [
            [
                "a7d0411b8d68b5a1"
            ]
        ]
    },
    {
        "id": "b235729f20069b7d",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 310,
        "y": 1340,
        "wires": [
            [
                "96074f98dd6204c8"
            ]
        ]
    },
    {
        "id": "fb7710509a9b6ed8",
        "type": "bcrypt",
        "z": "217d4457bda21c0d",
        "g": "2d8f9ba287e5298a",
        "name": "Hash password",
        "action": "encrypt",
        "field": "newPw",
        "hash": "payload",
        "target": "payload",
        "assignment": "replace",
        "match": "match",
        "outputs": 1,
        "rounds": 10,
        "x": 740,
        "y": 1340,
        "wires": [
            [
                "fb45f15a6ea25bf8"
            ]
        ]
    },
    {
        "id": "fd7954efe8da413c",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "link in 10",
        "links": [
            "aed1bb2bfb8d429a"
        ],
        "x": 665,
        "y": 4620,
        "wires": [
            [
                "b4bc44fd8fd0d81f",
                "fd8dcfa9337350f6"
            ]
        ]
    },
    {
        "id": "aed1bb2bfb8d429a",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "fd7954efe8da413c",
            "71a0df322767aff7"
        ],
        "x": 295,
        "y": 4620,
        "wires": []
    },
    {
        "id": "9935b7fb6f9babfb",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "1589093497ae43e3",
        "name": "Generate random name",
        "func": "const names = [\"Lucid Symphony\",\"Kinetic Horizon\",\n\"Cobalt Canopy\",\"Emberforge\",\n\"Zephyr Stream\",\"Evergreen Circuit\",\n\"Mindspring Protocol\",\"Stardust Archive\",\n\"Crimson Cascade\",\"Quantum Forge\"]\n\nmsg.payload.jugname = names[Math.floor(Math.random() * names.length)]\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 760,
        "wires": [
            [
                "dcd2b471dd5d1d54"
            ]
        ]
    },
    {
        "id": "88c0d713d6e98b81",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Get Total Litres",
        "url": "/getTotalLitres",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 2420,
        "wires": [
            [
                "5747a2e1c597aa27"
            ]
        ]
    },
    {
        "id": "c88dec8b993f57ff",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 2480,
        "wires": []
    },
    {
        "id": "5747a2e1c597aa27",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 2420,
        "wires": [
            [
                "6019fa6e45874eea"
            ]
        ]
    },
    {
        "id": "6019fa6e45874eea",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 2420,
        "wires": [
            [
                "d8773bd61cacfc72"
            ]
        ]
    },
    {
        "id": "d8773bd61cacfc72",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 2420,
        "wires": [
            [
                "c0a3cc43ed240f5b"
            ]
        ]
    },
    {
        "id": "c0a3cc43ed240f5b",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 2420,
        "wires": [
            [
                "6cf677b0282e4e6f"
            ]
        ]
    },
    {
        "id": "6cf677b0282e4e6f",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "",
        "x": 1030,
        "y": 2420,
        "wires": [
            [
                "7e1934dff3a0a28a"
            ]
        ]
    },
    {
        "id": "70275bf9e69b31a8",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Get Total Filtered",
        "url": "/getTotalLitresFilter",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 2660,
        "wires": [
            [
                "f30c4b594973b6d0"
            ]
        ]
    },
    {
        "id": "add5b2a33074ecf2",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 2720,
        "wires": []
    },
    {
        "id": "f30c4b594973b6d0",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 2660,
        "wires": [
            [
                "5aca1b2252a4f596"
            ]
        ]
    },
    {
        "id": "5aca1b2252a4f596",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 2660,
        "wires": [
            [
                "3c48160706d578ce"
            ]
        ]
    },
    {
        "id": "3c48160706d578ce",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 2660,
        "wires": [
            [
                "9e33abf723222f89"
            ]
        ]
    },
    {
        "id": "9e33abf723222f89",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 2660,
        "wires": [
            [
                "26e46da1d1e5c3bb"
            ]
        ]
    },
    {
        "id": "26e46da1d1e5c3bb",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "",
        "x": 1030,
        "y": 2660,
        "wires": [
            [
                "230126dfbb980168"
            ]
        ]
    },
    {
        "id": "5e7b335abac55f6c",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Get Daily Litres",
        "url": "/getDailyLitres",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 2900,
        "wires": [
            [
                "b367f3ce524cfd94"
            ]
        ]
    },
    {
        "id": "d162030e97e8b68c",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 3060,
        "wires": []
    },
    {
        "id": "b367f3ce524cfd94",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 2900,
        "wires": [
            [
                "8dc11046a4b37f58"
            ]
        ]
    },
    {
        "id": "8dc11046a4b37f58",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 2900,
        "wires": [
            [
                "450a2702b61f60ee"
            ]
        ]
    },
    {
        "id": "450a2702b61f60ee",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 2900,
        "wires": [
            [
                "866d839117c6f488"
            ]
        ]
    },
    {
        "id": "866d839117c6f488",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 2900,
        "wires": [
            [
                "153cd872af333754"
            ]
        ]
    },
    {
        "id": "153cd872af333754",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "",
        "x": 1030,
        "y": 2900,
        "wires": [
            [
                "76e804587421f2c6"
            ]
        ]
    },
    {
        "id": "8abf7961e74bc0f3",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Get Total Litres Completition",
        "scope": [
            "c88dec8b993f57ff"
        ],
        "uncaught": false,
        "x": 180,
        "y": 2540,
        "wires": [
            [
                "1d5006ae514a9d60"
            ]
        ]
    },
    {
        "id": "1d5006ae514a9d60",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Total Litres Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 2540,
        "wires": [
            [
                "a180b3c529b92aa1"
            ]
        ]
    },
    {
        "id": "a180b3c529b92aa1",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 2540,
        "wires": []
    },
    {
        "id": "08f34fd90c64243a",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Get Total Filtered Completition",
        "scope": [
            "add5b2a33074ecf2"
        ],
        "uncaught": false,
        "x": 180,
        "y": 2780,
        "wires": [
            [
                "62926aadba5250c7"
            ]
        ]
    },
    {
        "id": "62926aadba5250c7",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Total Filtered Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 2780,
        "wires": [
            [
                "fcbf3708e8ee6bd1"
            ]
        ]
    },
    {
        "id": "fcbf3708e8ee6bd1",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 2780,
        "wires": []
    },
    {
        "id": "f8c7d288452c7856",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Get Daily Litres Completition",
        "scope": [
            "d162030e97e8b68c"
        ],
        "uncaught": false,
        "x": 180,
        "y": 3100,
        "wires": [
            [
                "4d2a45258ed875aa"
            ]
        ]
    },
    {
        "id": "4d2a45258ed875aa",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Daily Litres Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 3100,
        "wires": [
            [
                "8234a0063469656b"
            ]
        ]
    },
    {
        "id": "8234a0063469656b",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 3100,
        "wires": []
    },
    {
        "id": "367f5704e274bbf0",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "debug 18",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 4340,
        "wires": []
    },
    {
        "id": "1356342fe4014956",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "server": "df153d084656312d",
        "command": "SET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1180,
        "y": 2000,
        "wires": [
            []
        ]
    },
    {
        "id": "63e674961c23831c",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "8b12de2fdf899788",
        "name": "Set last user active",
        "func": "msg.payload = [`last_active:${msg.token.userid}`, Math.floor(new Date().getTime() / 1000)];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 2000,
        "wires": [
            [
                "1356342fe4014956"
            ]
        ]
    },
    {
        "id": "8fca74c27b697c58",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Set redis payload",
        "func": "msg.payload = [`total:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 2480,
        "wires": [
            [
                "cae422b184195e66"
            ]
        ]
    },
    {
        "id": "cae422b184195e66",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1040,
        "y": 2480,
        "wires": [
            [
                "c88dec8b993f57ff"
            ]
        ]
    },
    {
        "id": "fe16e53c828639c6",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1020,
        "y": 2720,
        "wires": [
            [
                "add5b2a33074ecf2"
            ]
        ]
    },
    {
        "id": "c9e6d57afaa2e1d2",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Set redis payload",
        "func": "msg.payload = [`filtered:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 2720,
        "wires": [
            [
                "fe16e53c828639c6"
            ]
        ]
    },
    {
        "id": "6fc6bab94a4ae8e3",
        "type": "catch",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Redis Catch",
        "scope": [
            "1356342fe4014956",
            "cae422b184195e66",
            "fe16e53c828639c6",
            "c4187b0eda16efb5",
            "939b30d576b816e8",
            "20c748153a94c4d3",
            "13fa1725812d2a11"
        ],
        "uncaught": false,
        "x": 130,
        "y": 4620,
        "wires": [
            [
                "aed1bb2bfb8d429a"
            ]
        ]
    },
    {
        "id": "197c21e031466f25",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Set redis payload",
        "func": "const end = new Date();\nend.setHours(0);\nend.setMinutes(0);\nend.setSeconds(0);\nend.setMilliseconds(0);\n// take to 3 days before\nconst start = new Date(end.getTime() - 1000*60*60*24*3);\nmsg.payload = [`data:${msg.jug}`, start.getTime(), end.getTime()];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 2960,
        "wires": [
            [
                "13fa1725812d2a11"
            ]
        ]
    },
    {
        "id": "13fa1725812d2a11",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "server": "df153d084656312d",
        "command": "TS.RANGE",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 850,
        "y": 2960,
        "wires": [
            [
                "cfb0f979ae8433ec"
            ]
        ]
    },
    {
        "id": "76e804587421f2c6",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "link out 15",
        "mode": "link",
        "links": [
            "1c4c6a70bc144fd4",
            "d7feb0b9d9fb0c7f"
        ],
        "x": 1215,
        "y": 2900,
        "wires": []
    },
    {
        "id": "cfb0f979ae8433ec",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Return daily consumption",
        "func": "msg.payload = msg.payload.reduce((acc,[_, x])=>acc + Number(x), 0) / 3.0;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 2960,
        "wires": [
            [
                "d162030e97e8b68c"
            ]
        ]
    },
    {
        "id": "503fc13e9fcc1e71",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Set redis payload",
        "func": "msg.payload = [`total:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 2480,
        "wires": [
            [
                "939b30d576b816e8"
            ]
        ]
    },
    {
        "id": "939b30d576b816e8",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 460,
        "y": 2480,
        "wires": [
            [
                "9242f268ceac5f80"
            ]
        ]
    },
    {
        "id": "9242f268ceac5f80",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 640,
        "y": 2480,
        "wires": [
            [
                "8fca74c27b697c58"
            ],
            [
                "774fa1af8fabcee4"
            ]
        ]
    },
    {
        "id": "774fa1af8fabcee4",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "send zero",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 940,
        "y": 2540,
        "wires": [
            [
                "c88dec8b993f57ff"
            ]
        ]
    },
    {
        "id": "4f0f929e2bdad8b1",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "link in 17",
        "links": [
            "7e1934dff3a0a28a"
        ],
        "x": 125,
        "y": 2480,
        "wires": [
            [
                "503fc13e9fcc1e71"
            ]
        ]
    },
    {
        "id": "7e1934dff3a0a28a",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "534ca73506fdba18",
        "name": "link out 16",
        "mode": "link",
        "links": [
            "4f0f929e2bdad8b1"
        ],
        "x": 1205,
        "y": 2420,
        "wires": []
    },
    {
        "id": "d382bf1a389a091e",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Set redis payload",
        "func": "msg.payload = [`filtered:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 2720,
        "wires": [
            [
                "c4187b0eda16efb5"
            ]
        ]
    },
    {
        "id": "c4187b0eda16efb5",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 440,
        "y": 2720,
        "wires": [
            [
                "8ad121c2a63547a7"
            ]
        ]
    },
    {
        "id": "8ad121c2a63547a7",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 620,
        "y": 2720,
        "wires": [
            [
                "c9e6d57afaa2e1d2"
            ],
            [
                "9e47f17e93f6f62a"
            ]
        ]
    },
    {
        "id": "9e47f17e93f6f62a",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "send zero",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 2780,
        "wires": [
            [
                "add5b2a33074ecf2"
            ]
        ]
    },
    {
        "id": "f508643b3ae7fa41",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "link in 18",
        "links": [
            "230126dfbb980168"
        ],
        "x": 105,
        "y": 2720,
        "wires": [
            [
                "d382bf1a389a091e"
            ]
        ]
    },
    {
        "id": "230126dfbb980168",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "5e37b1309f768c0f",
        "name": "link out 17",
        "mode": "link",
        "links": [
            "f508643b3ae7fa41"
        ],
        "x": 1195,
        "y": 2660,
        "wires": []
    },
    {
        "id": "723b1a0e46b922e9",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 2960,
        "wires": [
            [
                "20c748153a94c4d3"
            ]
        ]
    },
    {
        "id": "20c748153a94c4d3",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 200,
        "y": 3020,
        "wires": [
            [
                "8caf1e9a1af62b24"
            ]
        ]
    },
    {
        "id": "8caf1e9a1af62b24",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 440,
        "y": 3020,
        "wires": [
            [
                "197c21e031466f25"
            ],
            [
                "94db9507db559498"
            ]
        ]
    },
    {
        "id": "d7feb0b9d9fb0c7f",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "link in 19",
        "links": [
            "76e804587421f2c6"
        ],
        "x": 75,
        "y": 2960,
        "wires": [
            [
                "723b1a0e46b922e9"
            ]
        ]
    },
    {
        "id": "94db9507db559498",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "de8fe453c32044e8",
        "name": "send zero",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1020,
        "y": 3060,
        "wires": [
            [
                "d162030e97e8b68c"
            ]
        ]
    },
    {
        "id": "acf957f36e4d2248",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Get Hour Litres",
        "url": "/getHourLitres",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 3220,
        "wires": [
            [
                "88989c2a21970a31"
            ]
        ]
    },
    {
        "id": "0ea290e2c6ce4a1a",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 3340,
        "wires": []
    },
    {
        "id": "88989c2a21970a31",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 3220,
        "wires": [
            [
                "cfa4d8d001d2130d"
            ]
        ]
    },
    {
        "id": "cfa4d8d001d2130d",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 3220,
        "wires": [
            [
                "14cf398477bf26d0"
            ]
        ]
    },
    {
        "id": "14cf398477bf26d0",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 3220,
        "wires": [
            [
                "1e46f3a730e93865"
            ]
        ]
    },
    {
        "id": "1e46f3a730e93865",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 3220,
        "wires": [
            [
                "b2e7b4682286c0d4"
            ]
        ]
    },
    {
        "id": "b2e7b4682286c0d4",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "",
        "x": 1030,
        "y": 3220,
        "wires": [
            [
                "7eba711de7147311"
            ]
        ]
    },
    {
        "id": "44eae3f24c85b15b",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Get Daily Litres Completition",
        "scope": [
            "0ea290e2c6ce4a1a"
        ],
        "uncaught": false,
        "x": 180,
        "y": 3420,
        "wires": [
            [
                "8aa960d00c5a8ae4"
            ]
        ]
    },
    {
        "id": "8aa960d00c5a8ae4",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Daily Litres Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 3420,
        "wires": [
            [
                "eacd17a053e0779c"
            ]
        ]
    },
    {
        "id": "eacd17a053e0779c",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 3420,
        "wires": []
    },
    {
        "id": "ef9ce4c7d61198bc",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Set redis payload",
        "func": "const end = new Date();\nend.setSeconds(0);\nend.setMilliseconds(0);\n\n// take values in the last hour\nconst start = new Date(end.getTime() - 1000*60*60);\nmsg.payload = [`data:${msg.jug}`, start.getTime(), end.getTime()];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 3280,
        "wires": [
            [
                "ec7c071b469780f2"
            ]
        ]
    },
    {
        "id": "ec7c071b469780f2",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "server": "df153d084656312d",
        "command": "TS.RANGE",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 850,
        "y": 3280,
        "wires": [
            [
                "989d130aaff9ec32"
            ]
        ]
    },
    {
        "id": "7eba711de7147311",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "link out 18",
        "mode": "link",
        "links": [
            "1c4c6a70bc144fd4",
            "ac4c21fa9e6f4081"
        ],
        "x": 1215,
        "y": 3220,
        "wires": []
    },
    {
        "id": "989d130aaff9ec32",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Return hour consumption",
        "func": "let current = new Date();\ncurrent.setSeconds(0);\ncurrent.setMilliseconds(0);\nconst currentTime = current.getTime();\nconst bin = Array(60);\n\nfor (let i=0; i < bin.length; ++i)\n    bin[i] = 0;\n\nfor (let i = 0; i < msg.payload.length; ++i){\n    const previous = msg.payload[i][0];\n    const delta  = Math.floor((currentTime - previous) / 60000);\n    if (delta <= 0) continue;\n    bin[60 - delta] += Number(msg.payload[i][1]); // we exclude the current minute\n}\n\nmsg.payload = bin;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 3280,
        "wires": [
            [
                "0ea290e2c6ce4a1a"
            ]
        ]
    },
    {
        "id": "7d7228fcaa48450a",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 3280,
        "wires": [
            [
                "e44fe8f17ee918f9"
            ]
        ]
    },
    {
        "id": "e44fe8f17ee918f9",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 200,
        "y": 3340,
        "wires": [
            [
                "95ce10a1ba7f36bf"
            ]
        ]
    },
    {
        "id": "95ce10a1ba7f36bf",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 440,
        "y": 3340,
        "wires": [
            [
                "ef9ce4c7d61198bc"
            ],
            [
                "79d9fa22339e49fa"
            ]
        ]
    },
    {
        "id": "ac4c21fa9e6f4081",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "link in 20",
        "links": [
            "7eba711de7147311"
        ],
        "x": 75,
        "y": 3280,
        "wires": [
            [
                "7d7228fcaa48450a"
            ]
        ]
    },
    {
        "id": "cc10d96d6ab81846",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Get Week Litres",
        "url": "/getWeekLitres",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 3540,
        "wires": [
            [
                "1418c2b5174cb0ae"
            ]
        ]
    },
    {
        "id": "87169dea62c41da2",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 3660,
        "wires": []
    },
    {
        "id": "1418c2b5174cb0ae",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 3540,
        "wires": [
            [
                "7dea54595b2f8973"
            ]
        ]
    },
    {
        "id": "7dea54595b2f8973",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 3540,
        "wires": [
            [
                "ba2885d89716e281"
            ]
        ]
    },
    {
        "id": "ba2885d89716e281",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 610,
        "y": 3540,
        "wires": [
            [
                "ec027404c17ab3fd"
            ]
        ]
    },
    {
        "id": "ec027404c17ab3fd",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 3540,
        "wires": [
            [
                "aba17aa9b2a924c5"
            ]
        ]
    },
    {
        "id": "aba17aa9b2a924c5",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "",
        "x": 1030,
        "y": 3540,
        "wires": [
            [
                "cbc189df5bfca31d"
            ]
        ]
    },
    {
        "id": "2ccede54a4a5a04f",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Get Daily Litres Completition",
        "scope": [
            "87169dea62c41da2"
        ],
        "uncaught": false,
        "x": 180,
        "y": 3740,
        "wires": [
            [
                "85c51a301d79a3b0"
            ]
        ]
    },
    {
        "id": "85c51a301d79a3b0",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Daily Litres Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 3740,
        "wires": [
            [
                "dc0a8d8472d69018"
            ]
        ]
    },
    {
        "id": "dc0a8d8472d69018",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 3740,
        "wires": []
    },
    {
        "id": "d8846e0f63492e5c",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Set redis payload",
        "func": "const end = new Date();\n\n// take values in the last 7 days\nconst start = new Date(end.getTime() - 1000*60*60*24*7);\nstart.setHours(0);\nstart.setMinutes(0);\nstart.setSeconds(0);\nstart.setMilliseconds(0);\nmsg.payload = [`data:${msg.jug}`, start.getTime(), end.getTime()];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 3600,
        "wires": [
            [
                "8c76afa0ac7889a5"
            ]
        ]
    },
    {
        "id": "8c76afa0ac7889a5",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "server": "df153d084656312d",
        "command": "TS.RANGE",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 850,
        "y": 3600,
        "wires": [
            [
                "548e41b7da4c5532"
            ]
        ]
    },
    {
        "id": "cbc189df5bfca31d",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "link out 19",
        "mode": "link",
        "links": [
            "1c4c6a70bc144fd4",
            "9585c3ce74a4d1a1"
        ],
        "x": 1215,
        "y": 3540,
        "wires": []
    },
    {
        "id": "548e41b7da4c5532",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Return week consumption",
        "func": "const current = new Date().getTime();\nlet bin = Array(7);\n\nfor (let i = 0; i < bin.length; ++i)\n    bin[i] = 0;\n\nfor (let i = 0; i < msg.payload.length; ++i){\n    let previous = msg.payload[i][0];\n    const delta  = Math.floor((current - previous) / (1000 * 60 * 60 * 24));\n    bin[7 - 1 - delta] += Number(msg.payload[i][1]); // we include the current day\n}\n\nmsg.payload = bin;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 3600,
        "wires": [
            [
                "87169dea62c41da2"
            ]
        ]
    },
    {
        "id": "ea7b563a11080719",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 3600,
        "wires": [
            [
                "9163bec8860ad4f9"
            ]
        ]
    },
    {
        "id": "9163bec8860ad4f9",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 200,
        "y": 3660,
        "wires": [
            [
                "7752b3837f5c9557"
            ]
        ]
    },
    {
        "id": "7752b3837f5c9557",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 440,
        "y": 3660,
        "wires": [
            [
                "d8846e0f63492e5c"
            ],
            [
                "55640c5cfc5fcb66"
            ]
        ]
    },
    {
        "id": "9585c3ce74a4d1a1",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "link in 21",
        "links": [
            "cbc189df5bfca31d"
        ],
        "x": 75,
        "y": 3600,
        "wires": [
            [
                "ea7b563a11080719"
            ]
        ]
    },
    {
        "id": "79d9fa22339e49fa",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "e39613053ecf19ba",
        "name": "Send zero array",
        "func": "let bin = Array(60);\n\nfor (let i=0; i < 60; ++i)\n    bin[i] = 0;\n\nmsg.payload = bin;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 3340,
        "wires": [
            [
                "0ea290e2c6ce4a1a"
            ]
        ]
    },
    {
        "id": "55640c5cfc5fcb66",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "87a70ae14006afaf",
        "name": "Send zero array",
        "func": "let bin = Array(60);\n\nfor (let i=0; i < 60; ++i)\n    bin[i] = 0;\n\nmsg.payload = bin;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 3660,
        "wires": [
            [
                "87169dea62c41da2"
            ]
        ]
    },
    {
        "id": "8f712530a5c66d57",
        "type": "inject",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 4460,
        "wires": [
            [
                "50f589db459557ce"
            ]
        ]
    },
    {
        "id": "50f589db459557ce",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "Show FB_TOKENS table",
        "query": "SELECT * FROM FirebaseTokens;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 350,
        "y": 4460,
        "wires": [
            [
                "82e4247a771226d0"
            ]
        ]
    },
    {
        "id": "82e4247a771226d0",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "dd69043d1cb5236a",
        "name": "debug 30",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 4460,
        "wires": []
    },
    {
        "id": "42eaea6f2fbfb1e4",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Set Location",
        "url": "/setLocation",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 4100,
        "wires": [
            [
                "4a3dd7bf7cbcc405"
            ]
        ]
    },
    {
        "id": "f7237cf3043d6090",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 780,
        "y": 4160,
        "wires": []
    },
    {
        "id": "4a3dd7bf7cbcc405",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 270,
        "y": 4100,
        "wires": [
            [
                "aeac0f7ba5098724"
            ]
        ]
    },
    {
        "id": "aeac0f7ba5098724",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Extract id, lat, lon, token",
        "rules": [
            {
                "t": "set",
                "p": "lat",
                "pt": "msg",
                "to": "payload.lat",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lon",
                "pt": "msg",
                "to": "payload.lon",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 4100,
        "wires": [
            [
                "6eeb14468afaed1f"
            ]
        ]
    },
    {
        "id": "59b79324370ce600",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 4100,
        "wires": [
            [
                "b662a3a1f6e7fec3"
            ]
        ]
    },
    {
        "id": "b662a3a1f6e7fec3",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "",
        "x": 1070,
        "y": 4100,
        "wires": [
            [
                "f2961548194dc877"
            ]
        ]
    },
    {
        "id": "25a30e09aab14018",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Set Location completed",
        "scope": [
            "f7237cf3043d6090"
        ],
        "uncaught": false,
        "x": 160,
        "y": 4220,
        "wires": [
            [
                "cd58d3bd7a4a4f5e"
            ]
        ]
    },
    {
        "id": "cd58d3bd7a4a4f5e",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Set Location request completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 4220,
        "wires": [
            [
                "2880cb275f1a652c"
            ]
        ]
    },
    {
        "id": "2880cb275f1a652c",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 4220,
        "wires": []
    },
    {
        "id": "f2961548194dc877",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "link out 26",
        "mode": "link",
        "links": [
            "1c4c6a70bc144fd4",
            "01e3a3cc433b1c59"
        ],
        "x": 1305,
        "y": 4100,
        "wires": []
    },
    {
        "id": "6eeb14468afaed1f",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 650,
        "y": 4100,
        "wires": [
            [
                "59b79324370ce600"
            ]
        ]
    },
    {
        "id": "01e3a3cc433b1c59",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "link in 28",
        "links": [
            "f2961548194dc877"
        ],
        "x": 75,
        "y": 4160,
        "wires": [
            [
                "ac7791be6d092be9"
            ]
        ]
    },
    {
        "id": "bb6ab39b15241f2d",
        "type": "postgresql",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Set Jug Location",
        "query": "UPDATE JugTable SET lat = $2, lon = $3 WHERE id = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 510,
        "y": 4160,
        "wires": [
            [
                "f7237cf3043d6090"
            ]
        ]
    },
    {
        "id": "ac7791be6d092be9",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "19762fd47b742d3c",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.lat, msg.lon]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 250,
        "y": 4160,
        "wires": [
            [
                "bb6ab39b15241f2d"
            ]
        ]
    },
    {
        "id": "019d6130afe1d91d",
        "type": "catch",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "JWT Errors",
        "scope": [
            "6737c839da4aeeab",
            "378b9baed000b7e6",
            "86072dca8a4675b9",
            "c243a77177af6c13",
            "893577be1c16039b",
            "5b06d76a9679e1cb",
            "47e2ea0a595f5919",
            "3fc7f576baa8f340",
            "12f171e5e2f97465",
            "d8773bd61cacfc72",
            "3c48160706d578ce",
            "450a2702b61f60ee",
            "14cf398477bf26d0",
            "ba2885d89716e281",
            "6eeb14468afaed1f"
        ],
        "uncaught": false,
        "x": 130,
        "y": 4700,
        "wires": [
            [
                "5820aa3bb72d4b30"
            ]
        ]
    },
    {
        "id": "5820aa3bb72d4b30",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "d4ecc9458d879224",
        "name": "Craft Return Status \"INVALID_JWT\" (401)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "401",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 940,
        "y": 4700,
        "wires": [
            [
                "98c6aa8214050734"
            ]
        ]
    },
    {
        "id": "11a7c9e7ad6fe7f2",
        "type": "http in",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Get Litres Per Second",
        "url": "/getLitresPerSecond",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 3860,
        "wires": [
            [
                "4e2adf6367a314d3"
            ]
        ]
    },
    {
        "id": "5b2c61639699e9bd",
        "type": "http response",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1240,
        "y": 3920,
        "wires": []
    },
    {
        "id": "4e2adf6367a314d3",
        "type": "json",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "to obj",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 330,
        "y": 3860,
        "wires": [
            [
                "22c69011f164d339"
            ]
        ]
    },
    {
        "id": "22c69011f164d339",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Extract id, token",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "payload.token",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "jug",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 3860,
        "wires": [
            [
                "6eba11501d2c7ff8"
            ]
        ]
    },
    {
        "id": "6eba11501d2c7ff8",
        "type": "jwt verify",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "",
        "alg": [
            "HS256"
        ],
        "jwkurl": "",
        "secret": "secret",
        "key": "",
        "signvar": "token",
        "storetoken": "token",
        "x": 650,
        "y": 3860,
        "wires": [
            [
                "2a13828b9b195505"
            ]
        ]
    },
    {
        "id": "2a13828b9b195505",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Set params (jugId, userId)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug, msg.token.userid]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 3860,
        "wires": [
            [
                "2a7afbe0b1c488c5"
            ]
        ]
    },
    {
        "id": "2a7afbe0b1c488c5",
        "type": "subflow:e6c0f715714d0f23",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "",
        "x": 1070,
        "y": 3860,
        "wires": [
            [
                "6143345bbc46fc25"
            ]
        ]
    },
    {
        "id": "eb7830540f34e3ce",
        "type": "complete",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Get Total Filtered Completition",
        "scope": [
            "5b2c61639699e9bd"
        ],
        "uncaught": false,
        "x": 180,
        "y": 3980,
        "wires": [
            [
                "4bf239c3a4a0de65"
            ]
        ]
    },
    {
        "id": "4bf239c3a4a0de65",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Craft success msg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Get Total Filtered Completed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 3980,
        "wires": [
            [
                "d64a1cc371e281bb"
            ]
        ]
    },
    {
        "id": "d64a1cc371e281bb",
        "type": "debug",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Print result",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 3980,
        "wires": []
    },
    {
        "id": "9704ef73f33b2c9c",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1020,
        "y": 3920,
        "wires": [
            [
                "5b2c61639699e9bd"
            ]
        ]
    },
    {
        "id": "0173dbee92a8f9ea",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Set redis payload",
        "func": "msg.payload = [`litresPerSecond:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 3920,
        "wires": [
            [
                "9704ef73f33b2c9c"
            ]
        ]
    },
    {
        "id": "31a11d46097a68de",
        "type": "function",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Set redis payload",
        "func": "msg.payload = [`litresPerSecond:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 3920,
        "wires": [
            [
                "3ef3e0aa69f76957"
            ]
        ]
    },
    {
        "id": "3ef3e0aa69f76957",
        "type": "redis-command",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 440,
        "y": 3920,
        "wires": [
            [
                "87d2f74c18ab7d50"
            ]
        ]
    },
    {
        "id": "87d2f74c18ab7d50",
        "type": "switch",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "Property exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 620,
        "y": 3920,
        "wires": [
            [
                "0173dbee92a8f9ea"
            ],
            [
                "64d4eb4301561a6c"
            ]
        ]
    },
    {
        "id": "64d4eb4301561a6c",
        "type": "change",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "send zero",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 3980,
        "wires": [
            [
                "5b2c61639699e9bd"
            ]
        ]
    },
    {
        "id": "d0d8c28baef09709",
        "type": "link in",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "link in 30",
        "links": [
            "6143345bbc46fc25"
        ],
        "x": 105,
        "y": 3920,
        "wires": [
            [
                "31a11d46097a68de"
            ]
        ]
    },
    {
        "id": "6143345bbc46fc25",
        "type": "link out",
        "z": "217d4457bda21c0d",
        "g": "fa50a94c7828706e",
        "name": "link out 27",
        "mode": "link",
        "links": [
            "d0d8c28baef09709"
        ],
        "x": 1195,
        "y": 3860,
        "wires": []
    },
    {
        "id": "21d2d9cfcaed8d56",
        "type": "redis-instance",
        "z": "7af354fb2230bd6b",
        "server": "df153d084656312d",
        "name": "",
        "topic": "redis",
        "location": "global",
        "x": 90,
        "y": 60,
        "wires": []
    },
    {
        "id": "ba928c6f3cbb3d2a",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 540,
        "y": 240,
        "wires": [
            [
                "0cedf5ca6574b456"
            ]
        ]
    },
    {
        "id": "03f0f11ab805879e",
        "type": "inject",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Start process",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "6f73efdd004966a4",
        "type": "postgresql",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Select all jugs",
        "query": "SELECT * FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 240,
        "y": 160,
        "wires": [
            [
                "6a11b96d12bac454"
            ]
        ]
    },
    {
        "id": "f4b3f90ad6ba0cda",
        "type": "delay",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1060,
        "y": 320,
        "wires": [
            [
                "a2a3b1eb4e88c290"
            ]
        ]
    },
    {
        "id": "6a11b96d12bac454",
        "type": "split",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 390,
        "y": 160,
        "wires": [
            [
                "c61ed3ee177c18b6"
            ]
        ]
    },
    {
        "id": "f9fb5265d504b778",
        "type": "join",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 910,
        "y": 320,
        "wires": [
            [
                "f4b3f90ad6ba0cda"
            ]
        ]
    },
    {
        "id": "77ca70b72d5388f6",
        "type": "http request",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Request Daily Stream",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jug}}/Services/QueryPropertyHistory",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 180,
        "y": 980,
        "wires": [
            [
                "4034126e43898b85"
            ]
        ]
    },
    {
        "id": "0cedf5ca6574b456",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Check for active users",
        "func": "let delta = Number(msg.payload) - new Date().getTime() / 1000; \n// Trigger an update of data if the user has been active in the last hour\nreturn delta > -3600 ? [msg, null] : [null, msg];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 240,
        "wires": [
            [
                "e92695e056a65f95"
            ],
            [
                "b5a9c745b6311f75"
            ]
        ]
    },
    {
        "id": "b451c92a53a5cad0",
        "type": "inject",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Manual start",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 300,
        "wires": [
            [
                "6f73efdd004966a4"
            ]
        ]
    },
    {
        "id": "c61ed3ee177c18b6",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Set payload to userid and backup jug",
        "func": "msg.jug = msg.payload.id;\nmsg.userid=msg.payload.userid;\nmsg.payload = [`last_active:${msg.userid}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 160,
        "wires": [
            [
                "9658923e20f54f1d"
            ]
        ]
    },
    {
        "id": "f52f87f8bdfaeeae",
        "type": "http request",
        "z": "7af354fb2230bd6b",
        "g": "b4ccca51421e7bbd",
        "name": "Get Total litres",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jug}}/Properties/totalLitresJug",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 220,
        "y": 440,
        "wires": [
            [
                "ab335792236b7f7e"
            ]
        ]
    },
    {
        "id": "71c22c22246715dd",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "b4ccca51421e7bbd",
        "server": "df153d084656312d",
        "command": "SET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 600,
        "y": 440,
        "wires": [
            [
                "3bc7dbfaf2527fba"
            ]
        ]
    },
    {
        "id": "ab335792236b7f7e",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "b4ccca51421e7bbd",
        "name": "Set redis payload",
        "func": "msg.payload = [`total:${msg.jug}`, msg.payload.rows[0].totalLitresJug];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 440,
        "wires": [
            [
                "71c22c22246715dd"
            ]
        ]
    },
    {
        "id": "6595481df1f98efd",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link in 11",
        "links": [
            "a2a3b1eb4e88c290"
        ],
        "x": 85,
        "y": 160,
        "wires": [
            [
                "6f73efdd004966a4"
            ]
        ]
    },
    {
        "id": "a2a3b1eb4e88c290",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 9",
        "mode": "link",
        "links": [
            "6595481df1f98efd"
        ],
        "x": 1165,
        "y": 320,
        "wires": []
    },
    {
        "id": "ba7f434ec626a3de",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link in 12",
        "links": [
            "b5a9c745b6311f75"
        ],
        "x": 345,
        "y": 320,
        "wires": [
            [
                "5b48393db4e27cf6"
            ]
        ]
    },
    {
        "id": "b5a9c745b6311f75",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 10",
        "mode": "link",
        "links": [
            "ba7f434ec626a3de",
            "bb3c30d868248d31"
        ],
        "x": 835,
        "y": 260,
        "wires": []
    },
    {
        "id": "347d9f4ea62ff99c",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 11",
        "mode": "link",
        "links": [
            "87b2ec98fde60d9b"
        ],
        "x": 1035,
        "y": 220,
        "wires": []
    },
    {
        "id": "87b2ec98fde60d9b",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "b4ccca51421e7bbd",
        "name": "link in 13",
        "links": [
            "347d9f4ea62ff99c"
        ],
        "x": 85,
        "y": 440,
        "wires": [
            [
                "f52f87f8bdfaeeae"
            ]
        ]
    },
    {
        "id": "3bc7dbfaf2527fba",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "b4ccca51421e7bbd",
        "name": "link out 12",
        "mode": "link",
        "links": [
            "675d2f9aa578f26f"
        ],
        "x": 735,
        "y": 440,
        "wires": []
    },
    {
        "id": "47bed87945d83ae7",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "link in 14",
        "links": [
            "ada19a977d39bf9f"
        ],
        "x": 85,
        "y": 800,
        "wires": [
            [
                "768a9020e1322e49"
            ]
        ]
    },
    {
        "id": "bb0181636da5a32c",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "link out 13",
        "mode": "link",
        "links": [
            "bb3c30d868248d31"
        ],
        "x": 1075,
        "y": 1020,
        "wires": []
    },
    {
        "id": "8b4c024a3605a5a6",
        "type": "http response",
        "z": "7af354fb2230bd6b",
        "g": "519e102431c6adfb",
        "name": "Response Error",
        "statusCode": "",
        "headers": {},
        "x": 700,
        "y": 1180,
        "wires": []
    },
    {
        "id": "25d8bbe0d875987c",
        "type": "catch",
        "z": "7af354fb2230bd6b",
        "g": "519e102431c6adfb",
        "name": "Catch All",
        "scope": null,
        "uncaught": true,
        "x": 140,
        "y": 1140,
        "wires": [
            [
                "face9a42b4eb7c11",
                "832ad02bc89947a0"
            ]
        ]
    },
    {
        "id": "face9a42b4eb7c11",
        "type": "change",
        "z": "7af354fb2230bd6b",
        "g": "519e102431c6adfb",
        "name": "Craft Return Status \"SERVER_ERROR\" (500)",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 1180,
        "wires": [
            [
                "8b4c024a3605a5a6"
            ]
        ]
    },
    {
        "id": "832ad02bc89947a0",
        "type": "debug",
        "z": "7af354fb2230bd6b",
        "g": "519e102431c6adfb",
        "name": "Print error msg (API)",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "error.message",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 340,
        "y": 1140,
        "wires": []
    },
    {
        "id": "cad543a44ef8ac79",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 400,
        "y": 800,
        "wires": [
            [
                "e17f38b724cef952"
            ]
        ]
    },
    {
        "id": "768a9020e1322e49",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 800,
        "wires": [
            [
                "cad543a44ef8ac79"
            ]
        ]
    },
    {
        "id": "e17f38b724cef952",
        "type": "switch",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Is not already created?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 600,
        "y": 800,
        "wires": [
            [
                "31ff0273f34611eb"
            ],
            [
                "345e9507d7a3b201"
            ]
        ]
    },
    {
        "id": "31ff0273f34611eb",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`, \"RETENTION\", 1000*60*60*24*7];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 800,
        "wires": [
            [
                "e5460c07c86d70f6"
            ]
        ]
    },
    {
        "id": "e5460c07c86d70f6",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "server": "df153d084656312d",
        "command": "TS.CREATE",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1030,
        "y": 800,
        "wires": [
            [
                "345e9507d7a3b201"
            ]
        ]
    },
    {
        "id": "4034126e43898b85",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Set redis payload",
        "func": "const arr = [];\nconst data = msg.payload.rows;\nfor (let i=0; i < data.length; ++i){\n    let elem = [`data:${msg.jug}`, data[i].timestamp, data[i].litresPerSecond];\n    arr.push(...elem);\n}\nmsg.payload = arr;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 980,
        "wires": [
            [
                "467b19b451346f48"
            ]
        ]
    },
    {
        "id": "a175f8a745e83e2f",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "server": "df153d084656312d",
        "command": "TS.MADD",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 960,
        "y": 960,
        "wires": [
            [
                "bb0181636da5a32c"
            ]
        ]
    },
    {
        "id": "2e951943e6dc5046",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "server": "df153d084656312d",
        "command": "TS.GET",
        "name": "Get most recent time saved on Redis",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 470,
        "y": 860,
        "wires": [
            [
                "662638515caf474e"
            ]
        ]
    },
    {
        "id": "345e9507d7a3b201",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Set redis payload",
        "func": "msg.payload = [`data:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 860,
        "wires": [
            [
                "2e951943e6dc5046"
            ]
        ]
    },
    {
        "id": "661d4502910d1445",
        "type": "http request",
        "z": "7af354fb2230bd6b",
        "g": "e629f80dbbf9bdfe",
        "name": "Get Total filtered",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jug}}/Properties/totalLitresFilter",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 220,
        "y": 560,
        "wires": [
            [
                "be6d0c370fa944fd"
            ]
        ]
    },
    {
        "id": "0a68b2785038f103",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "e629f80dbbf9bdfe",
        "server": "df153d084656312d",
        "command": "SET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 600,
        "y": 560,
        "wires": [
            [
                "ab20fd40b692ceb9"
            ]
        ]
    },
    {
        "id": "be6d0c370fa944fd",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e629f80dbbf9bdfe",
        "name": "Set redis payload",
        "func": "msg.payload = [`filtered:${msg.jug}`, msg.payload.rows[0].totalLitresFilter];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 560,
        "wires": [
            [
                "0a68b2785038f103"
            ]
        ]
    },
    {
        "id": "675d2f9aa578f26f",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "e629f80dbbf9bdfe",
        "name": "link in 15",
        "links": [
            "3bc7dbfaf2527fba"
        ],
        "x": 85,
        "y": 560,
        "wires": [
            [
                "661d4502910d1445"
            ]
        ]
    },
    {
        "id": "ab20fd40b692ceb9",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "e629f80dbbf9bdfe",
        "name": "link out 14",
        "mode": "link",
        "links": [
            "d5aa805bcb588c36"
        ],
        "x": 735,
        "y": 560,
        "wires": []
    },
    {
        "id": "467b19b451346f48",
        "type": "switch",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Is array not empty?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 670,
        "y": 980,
        "wires": [
            [
                "a175f8a745e83e2f"
            ],
            [
                "bb0181636da5a32c"
            ]
        ]
    },
    {
        "id": "662638515caf474e",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "e781aa7211d99e25",
        "name": "Set request params",
        "func": "// If time not specified, request all data withing a week\nlet seven_days_ago = new Date()\nseven_days_ago.setHours(0);\nseven_days_ago.setMinutes(0);\nseven_days_ago.setSeconds(0);\nseven_days_ago.setMilliseconds(0);\nseven_days_ago = seven_days_ago.getTime() - 1000*60*60*24*7;  \nmsg.payload = {\"startDate\": msg.payload.length == 0 ? seven_days_ago : msg.payload[0] + 1};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 860,
        "wires": [
            [
                "77ca70b72d5388f6"
            ]
        ]
    },
    {
        "id": "801ac7e0744b9782",
        "type": "http request",
        "z": "7af354fb2230bd6b",
        "g": "35a931a21e40509a",
        "name": "Get Litres per second",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{jug}}/Properties/litresPerSecond",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 240,
        "y": 680,
        "wires": [
            [
                "04e7e283f60a887d"
            ]
        ]
    },
    {
        "id": "e6e04b436010c8f9",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "35a931a21e40509a",
        "server": "df153d084656312d",
        "command": "SET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 620,
        "y": 680,
        "wires": [
            [
                "ada19a977d39bf9f"
            ]
        ]
    },
    {
        "id": "04e7e283f60a887d",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "35a931a21e40509a",
        "name": "Set redis payload",
        "func": "msg.payload = [`litresPerSecond:${msg.jug}`, msg.payload.rows[0].litresPerSecond];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 680,
        "wires": [
            [
                "e6e04b436010c8f9"
            ]
        ]
    },
    {
        "id": "d5aa805bcb588c36",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "35a931a21e40509a",
        "name": "link in 31",
        "links": [
            "ab20fd40b692ceb9"
        ],
        "x": 85,
        "y": 680,
        "wires": [
            [
                "801ac7e0744b9782"
            ]
        ]
    },
    {
        "id": "ada19a977d39bf9f",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "35a931a21e40509a",
        "name": "link out 28",
        "mode": "link",
        "links": [
            "47bed87945d83ae7"
        ],
        "x": 735,
        "y": 680,
        "wires": []
    },
    {
        "id": "b404f05e23d9d205",
        "type": "mqtt in",
        "z": "7af354fb2230bd6b",
        "name": "",
        "topic": "/Thingworx/+/litresPerSecond",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "c77abff0c3609a0d",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 1280,
        "wires": [
            [
                "f3bb554eed845404"
            ]
        ]
    },
    {
        "id": "f3bb554eed845404",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "name": "function 1",
        "func": "const [_,__,name,___]=msg.topic.split('/')\nconst idString=name.substring(3)\nif(idString.length===0)return [null,msg]\nconst jugId=Number(idString)\nif(jugId===undefined)return [null,msg]\nmsg.jug=jugId\nmsg.litrespersecond=msg.payload\nmsg.params=[jugId]\nmsg.topic=undefined\nreturn [msg,null];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 1280,
        "wires": [
            [
                "ec9a9fdbe75de819"
            ],
            []
        ]
    },
    {
        "id": "ec9a9fdbe75de819",
        "type": "postgresql",
        "z": "7af354fb2230bd6b",
        "name": "",
        "query": "SELECT userId FROM JugTable where id=$1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 510,
        "y": 1280,
        "wires": [
            [
                "b19a5fa95b01884a"
            ]
        ]
    },
    {
        "id": "9b8e790ce8a28860",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 140,
        "y": 1460,
        "wires": [
            [
                "495c2f3c48471cb6"
            ]
        ]
    },
    {
        "id": "495c2f3c48471cb6",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "name": "Check for active users",
        "func": "let delta = Number(msg.payload) - new Date().getTime() / 1000; \n// Trigger an update of data if the user has been active in the last hour\nreturn delta > -3600 ? [msg, null] : [null, msg];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 1460,
        "wires": [
            [
                "512e731f79ab66bf"
            ],
            []
        ]
    },
    {
        "id": "46659fd914033c39",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "name": "function 3",
        "func": "msg.payload=[`last_active:${msg.userid}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 1280,
        "wires": [
            [
                "9b8e790ce8a28860"
            ]
        ]
    },
    {
        "id": "0d09c9a9e26103a3",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "server": "df153d084656312d",
        "command": "SET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 740,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "512e731f79ab66bf",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "name": "function 4",
        "func": "msg.payload = [`litresPerSecond:${msg.jug}`,msg.litrespersecond];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 1440,
        "wires": [
            [
                "0d09c9a9e26103a3"
            ]
        ]
    },
    {
        "id": "e92695e056a65f95",
        "type": "delay",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 930,
        "y": 220,
        "wires": [
            [
                "347d9f4ea62ff99c"
            ]
        ]
    },
    {
        "id": "9658923e20f54f1d",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 880,
        "y": 160,
        "wires": [
            [
                "469cb585e1809695"
            ]
        ]
    },
    {
        "id": "469cb585e1809695",
        "type": "switch",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Does exists?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1050,
        "y": 160,
        "wires": [
            [
                "14d37406895bec8d"
            ],
            [
                "67610ee6c5d7a538"
            ]
        ]
    },
    {
        "id": "67610ee6c5d7a538",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 29",
        "mode": "link",
        "links": [
            "bb3c30d868248d31"
        ],
        "x": 1165,
        "y": 200,
        "wires": []
    },
    {
        "id": "14d37406895bec8d",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 30",
        "mode": "link",
        "links": [
            "7018ca34006a871a"
        ],
        "x": 1165,
        "y": 140,
        "wires": []
    },
    {
        "id": "7018ca34006a871a",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link in 32",
        "links": [
            "14d37406895bec8d"
        ],
        "x": 315,
        "y": 240,
        "wires": [
            [
                "b0ee92db4b65ba08"
            ]
        ]
    },
    {
        "id": "5b48393db4e27cf6",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "Prepare all data",
        "func": "msg.payload=[\n    `last_active:${msg.userid}`,\n    `total:${msg.jug}`,\n    `filtered:${msg.jug}`,\n    `litresPerSecond:${msg.jug}`,\n    `data:${msg.jug}`,\n];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 320,
        "wires": [
            [
                "99e53198b6af5126"
            ]
        ]
    },
    {
        "id": "99e53198b6af5126",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "server": "df153d084656312d",
        "command": "DEL",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 620,
        "y": 320,
        "wires": [
            [
                "42cb9c76c9a980d2"
            ]
        ]
    },
    {
        "id": "bb3c30d868248d31",
        "type": "link in",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link in 33",
        "links": [
            "b5a9c745b6311f75",
            "bb0181636da5a32c",
            "67610ee6c5d7a538",
            "42cb9c76c9a980d2"
        ],
        "x": 825,
        "y": 320,
        "wires": [
            [
                "f9fb5265d504b778"
            ]
        ]
    },
    {
        "id": "42cb9c76c9a980d2",
        "type": "link out",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "link out 31",
        "mode": "link",
        "links": [
            "bb3c30d868248d31"
        ],
        "x": 715,
        "y": 320,
        "wires": []
    },
    {
        "id": "b19a5fa95b01884a",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "name": "function 2",
        "func": "if(msg.payload.length==0)return [null,msg]\nmsg.userid=msg.payload[0].userid\nmsg.payload=[`last_active:${msg.userid}`];\nreturn [msg,null];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 1280,
        "wires": [
            [
                "2572bb3ef09625fc"
            ],
            []
        ]
    },
    {
        "id": "2572bb3ef09625fc",
        "type": "redis-command",
        "z": "7af354fb2230bd6b",
        "server": "df153d084656312d",
        "command": "EXISTS",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 840,
        "y": 1280,
        "wires": [
            [
                "d009265d20b0dd16"
            ]
        ]
    },
    {
        "id": "d009265d20b0dd16",
        "type": "switch",
        "z": "7af354fb2230bd6b",
        "name": "Is not already created?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1060,
        "y": 1280,
        "wires": [
            [
                "46659fd914033c39"
            ],
            []
        ]
    },
    {
        "id": "b0ee92db4b65ba08",
        "type": "function",
        "z": "7af354fb2230bd6b",
        "g": "38063613653e8a1a",
        "name": "function 5",
        "func": "msg.payload=[`last_active:${msg.userid}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 240,
        "wires": [
            [
                "ba928c6f3cbb3d2a"
            ]
        ]
    },
    {
        "id": "f1f33d90d871e986",
        "type": "firebase cloud messaging",
        "z": "2751cff285e8ba2d",
        "g": "4124681a5ccaaaf2",
        "name": "",
        "admin": "222522e409a8c70d",
        "kind": "data",
        "x": 810,
        "y": 400,
        "wires": [
            [
                "b87bc0b91bd20db0"
            ]
        ]
    },
    {
        "id": "0853278bb994a75e",
        "type": "postgresql",
        "z": "2751cff285e8ba2d",
        "name": "Select all jugs",
        "query": "SELECT * FROM JugTable NATURAL JOIN FirebaseTokens;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 360,
        "y": 120,
        "wires": [
            [
                "f03472c43cdfb9ee"
            ]
        ]
    },
    {
        "id": "f03472c43cdfb9ee",
        "type": "split",
        "z": "2751cff285e8ba2d",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 530,
        "y": 120,
        "wires": [
            [
                "0f9a065b6892bfb4"
            ]
        ]
    },
    {
        "id": "5f7c6db27edc37ad",
        "type": "inject",
        "z": "2751cff285e8ba2d",
        "name": "Manual start",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "0853278bb994a75e"
            ]
        ]
    },
    {
        "id": "0f9a065b6892bfb4",
        "type": "function",
        "z": "2751cff285e8ba2d",
        "name": "Set redis payload, save token, notified, filterCapacity, jugid",
        "func": "msg.token = msg.payload.token;\nmsg.jug = msg.payload.id;\nmsg.filterCapacity = msg.payload.filtercapacity;\nmsg.notified = msg.payload.notified;\nmsg.payload = [`filtered:${msg.jug}`];\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 120,
        "wires": [
            [
                "35750d7256961691"
            ]
        ]
    },
    {
        "id": "35750d7256961691",
        "type": "redis-command",
        "z": "2751cff285e8ba2d",
        "server": "df153d084656312d",
        "command": "GET",
        "name": "",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "payloadType": "json",
        "block": false,
        "x": 1120,
        "y": 120,
        "wires": [
            [
                "e0300de71dbc7972"
            ]
        ]
    },
    {
        "id": "b87bc0b91bd20db0",
        "type": "join",
        "z": "2751cff285e8ba2d",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 890,
        "y": 260,
        "wires": [
            [
                "9fdc5ace85da2c5e"
            ]
        ]
    },
    {
        "id": "9fdc5ace85da2c5e",
        "type": "delay",
        "z": "2751cff285e8ba2d",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1040,
        "y": 260,
        "wires": [
            [
                "cc148dcac4f795ee"
            ]
        ]
    },
    {
        "id": "e2d44055a3b0e842",
        "type": "change",
        "z": "2751cff285e8ba2d",
        "g": "4124681a5ccaaaf2",
        "name": "Prepare notification",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"jugId\":msg.jug}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "f1f33d90d871e986"
            ]
        ]
    },
    {
        "id": "44b8c9590517b097",
        "type": "link out",
        "z": "2751cff285e8ba2d",
        "name": "link out 20",
        "mode": "link",
        "links": [
            "c5c4ac09cd76ebdc"
        ],
        "x": 635,
        "y": 180,
        "wires": []
    },
    {
        "id": "c5c4ac09cd76ebdc",
        "type": "link in",
        "z": "2751cff285e8ba2d",
        "name": "link in 22",
        "links": [
            "44b8c9590517b097"
        ],
        "x": 55,
        "y": 400,
        "wires": [
            [
                "f4d89bedfabc836d"
            ]
        ]
    },
    {
        "id": "d1624d47bd1afc34",
        "type": "comment",
        "z": "2751cff285e8ba2d",
        "name": "Send notification to high filter usage per jug on mobile devices",
        "info": "",
        "x": 280,
        "y": 40,
        "wires": []
    },
    {
        "id": "f7c72e310b754640",
        "type": "postgresql",
        "z": "2751cff285e8ba2d",
        "name": "Set notified",
        "query": "UPDATE JugTable SET notified = true WHERE id = $1;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 390,
        "y": 400,
        "wires": [
            [
                "e2d44055a3b0e842"
            ]
        ]
    },
    {
        "id": "48f71ebb381121e0",
        "type": "switch",
        "z": "2751cff285e8ba2d",
        "name": "Is not already notified?",
        "property": "notified",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 480,
        "y": 200,
        "wires": [
            [
                "44b8c9590517b097"
            ],
            [
                "b87bc0b91bd20db0"
            ]
        ]
    },
    {
        "id": "d64f52ed335c5a12",
        "type": "link out",
        "z": "2751cff285e8ba2d",
        "name": "link out 24",
        "mode": "link",
        "links": [
            "c7c141178f166673"
        ],
        "x": 1345,
        "y": 260,
        "wires": []
    },
    {
        "id": "c7c141178f166673",
        "type": "link in",
        "z": "2751cff285e8ba2d",
        "name": "link in 26",
        "links": [
            "d64f52ed335c5a12"
        ],
        "x": 245,
        "y": 80,
        "wires": [
            [
                "0853278bb994a75e"
            ]
        ]
    },
    {
        "id": "e0300de71dbc7972",
        "type": "link out",
        "z": "2751cff285e8ba2d",
        "name": "link out 25",
        "mode": "link",
        "links": [
            "d83ecd2b2af82f6c"
        ],
        "x": 1245,
        "y": 120,
        "wires": []
    },
    {
        "id": "d83ecd2b2af82f6c",
        "type": "link in",
        "z": "2751cff285e8ba2d",
        "name": "link in 27",
        "links": [
            "e0300de71dbc7972"
        ],
        "x": 65,
        "y": 220,
        "wires": [
            [
                "770ee71c4249cdf4"
            ]
        ]
    },
    {
        "id": "f4d89bedfabc836d",
        "type": "change",
        "z": "2751cff285e8ba2d",
        "name": "Prepare params (jug)",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[msg.jug]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 400,
        "wires": [
            [
                "f7c72e310b754640"
            ]
        ]
    },
    {
        "id": "770ee71c4249cdf4",
        "type": "function",
        "z": "2751cff285e8ba2d",
        "name": "Is up to 80% usage?",
        "func": "return (msg.payload) && (msg.filterCapacity > 0) && (msg.payload >= msg.filterCapacity*0.8)  ? [msg, null] : [null, msg];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 220,
        "wires": [
            [
                "48f71ebb381121e0"
            ],
            [
                "b87bc0b91bd20db0"
            ]
        ]
    },
    {
        "id": "cc148dcac4f795ee",
        "type": "change",
        "z": "2751cff285e8ba2d",
        "name": "Reset params",
        "rules": [
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1220,
        "y": 260,
        "wires": [
            [
                "d64f52ed335c5a12"
            ]
        ]
    },
    {
        "id": "b81d18410f63c333",
        "type": "inject",
        "z": "2751cff285e8ba2d",
        "name": "Debug",
        "props": [
            {
                "p": "token",
                "v": "dnCaAoWORBOFHU6A0hLQ0d:APA91bFunsoTuxwPW9f-PZjAM9LU0Gh1I_Ka5135wQh7SkQ_zXfgzaUIvS1tgLdDFMlkRTXhxksffBKi6dfWArvAkI4mrCjCchMFnXpKFyxO7mOnNjdM0cZCnN2ur3hd72yUaakvQplk",
                "vt": "str"
            },
            {
                "p": "jug",
                "v": "3",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 520,
        "wires": [
            [
                "74ad2577a33aef69"
            ]
        ]
    },
    {
        "id": "74ad2577a33aef69",
        "type": "postgresql",
        "z": "2751cff285e8ba2d",
        "name": "Select all jugs",
        "query": "SELECT * FROM FirebaseTokens;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 320,
        "y": 520,
        "wires": [
            [
                "e2d44055a3b0e842"
            ]
        ]
    },
    {
        "id": "12d815057cd57334",
        "type": "http request",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "Get Total litres",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{thing_id}}/Properties/totalLitresJug",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 420,
        "y": 300,
        "wires": [
            [
                "cdb712ef947b9f93"
            ]
        ]
    },
    {
        "id": "bca0d49876942d04",
        "type": "inject",
        "z": "dd62ac133fb1360c",
        "name": "Start dashboard",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "686e392549632634",
                "b4bb400f7fb5444d"
            ]
        ]
    },
    {
        "id": "686e392549632634",
        "type": "postgresql",
        "z": "dd62ac133fb1360c",
        "g": "07434671c4362d4f",
        "name": "Get Jug ids",
        "query": "SELECT id FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 410,
        "y": 120,
        "wires": [
            [
                "43eb9f6208742902"
            ]
        ]
    },
    {
        "id": "0f36aa3917d94588",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "07434671c4362d4f",
        "name": "Set thing_id",
        "rules": [
            {
                "t": "set",
                "p": "thing_id",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 120,
        "wires": [
            [
                "62c0ce56e6d2d453"
            ]
        ]
    },
    {
        "id": "e2b41d91cb228409",
        "type": "join",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "Merge all jugs values",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "thing_id",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "",
        "reduceRight": true,
        "reduceExp": "msg.payload\t",
        "reduceInit": "0",
        "reduceInitType": "num",
        "reduceFixup": "",
        "x": 820,
        "y": 300,
        "wires": [
            [
                "4eb1c96a4b440d38",
                "cd95edaaaf747c92"
            ]
        ]
    },
    {
        "id": "43eb9f6208742902",
        "type": "split",
        "z": "dd62ac133fb1360c",
        "g": "07434671c4362d4f",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 570,
        "y": 120,
        "wires": [
            [
                "0f36aa3917d94588"
            ]
        ]
    },
    {
        "id": "cdb712ef947b9f93",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "Set totalLitresJug",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.rows[0].totalLitresJug",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 300,
        "wires": [
            [
                "e2b41d91cb228409"
            ]
        ]
    },
    {
        "id": "cd95edaaaf747c92",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "Compute sum",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$sum(msg.payload)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1020,
        "y": 320,
        "wires": [
            [
                "b1bfa462b34b5621",
                "a3cf40fceacb65df"
            ]
        ]
    },
    {
        "id": "a3cf40fceacb65df",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "",
        "group": "d1a0b3959db61542",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Total litres of all jugs",
        "label": "liters",
        "format": "{{msg.payload  | number: 2}}",
        "min": 0,
        "max": "1000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 1220,
        "y": 300,
        "wires": []
    },
    {
        "id": "fffcf2415ff35daf",
        "type": "postgresql",
        "z": "dd62ac133fb1360c",
        "g": "261acb4b06f35df7",
        "name": "Get Jugs Count",
        "query": "SELECT COUNT(id) FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 420,
        "y": 1140,
        "wires": [
            [
                "6426c3f9917d2081"
            ]
        ]
    },
    {
        "id": "e12e139248b70364",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "261acb4b06f35df7",
        "group": "2dab9229986fd1ba",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Num of jugs registered",
        "label": "Number of jugs registered:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 900,
        "y": 1140,
        "wires": []
    },
    {
        "id": "6426c3f9917d2081",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "261acb4b06f35df7",
        "name": "Set Jugs Count",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].count",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 1140,
        "wires": [
            [
                "e12e139248b70364",
                "ed3067e7caae1618",
                "33457bfaf6556358"
            ]
        ]
    },
    {
        "id": "6cc1040bfd802f1e",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "group": "a6a64a541ae8c000",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Kg of plastic saved",
        "label": "Kg of plastic saved",
        "format": "{{msg.payload | number: 4}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 910,
        "y": 880,
        "wires": []
    },
    {
        "id": "bf3e55578af7a2e4",
        "type": "calculator",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "",
        "inputMsgField": "payload",
        "outputMsgField": "payload",
        "operation": "div",
        "constant": "500000",
        "round": false,
        "truncate": false,
        "decimals": 0,
        "decimals2": 0,
        "x": 610,
        "y": 880,
        "wires": [
            [
                "6cc1040bfd802f1e",
                "fa768fe8dd244a44",
                "1b5612176c75fd15"
            ]
        ]
    },
    {
        "id": "3ef85ed4716564ae",
        "type": "calculator",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "Plastic",
        "inputMsgField": "payload",
        "outputMsgField": "payload",
        "operation": "mult",
        "constant": "32",
        "round": false,
        "truncate": false,
        "decimals": 0,
        "decimals2": 0,
        "x": 390,
        "y": 880,
        "wires": [
            [
                "bf3e55578af7a2e4"
            ]
        ]
    },
    {
        "id": "fa768fe8dd244a44",
        "type": "ui_chart",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "",
        "group": "a6a64a541ae8c000",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Amount of plastic saved (hour)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": true,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1a7cc1",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 930,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "96122b6e803914d0",
        "type": "postgresql",
        "z": "dd62ac133fb1360c",
        "g": "99bd9f011057c2f8",
        "name": "Get User ids from DB",
        "query": "SELECT COUNT(userId) FROM UserTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 440,
        "y": 1340,
        "wires": [
            [
                "c38392d9d315dc5d"
            ]
        ]
    },
    {
        "id": "c38392d9d315dc5d",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "99bd9f011057c2f8",
        "name": "Set Users Count",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].count",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 1340,
        "wires": [
            [
                "5415beb9fff2b624",
                "2e8fa7ec9d191f25",
                "e7bd29cb35dc2be0"
            ]
        ]
    },
    {
        "id": "5415beb9fff2b624",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "99bd9f011057c2f8",
        "group": "4bfb72e0581a07c0",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Num of users registered",
        "label": "Number of users registered:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 890,
        "y": 1340,
        "wires": []
    },
    {
        "id": "4eb1c96a4b440d38",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "Compute avg",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$average(payload)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 260,
        "wires": [
            [
                "72d7683f247d4f7a"
            ]
        ]
    },
    {
        "id": "72d7683f247d4f7a",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "",
        "group": "d1a0b3959db61542",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Avg litres of all jugs",
        "label": "liters",
        "format": "{{msg.payload  | number: 2}}",
        "min": 0,
        "max": "500",
        "colors": [
            "#00f094",
            "#00b0bd",
            "#4400ff"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 1210,
        "y": 260,
        "wires": []
    },
    {
        "id": "b1bfa462b34b5621",
        "type": "link out",
        "z": "dd62ac133fb1360c",
        "g": "44ca8a1c36ba7dc9",
        "name": "link out 5",
        "mode": "link",
        "links": [
            "72b8d5bea41ced2f"
        ],
        "x": 1145,
        "y": 340,
        "wires": []
    },
    {
        "id": "72b8d5bea41ced2f",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 5",
        "links": [
            "b1bfa462b34b5621"
        ],
        "x": 255,
        "y": 880,
        "wires": [
            [
                "3ef85ed4716564ae",
                "ae2b33962a87399a",
                "a492687f220674ec",
                "a4d6a0147eedd8e8"
            ]
        ]
    },
    {
        "id": "2ad5bd5afacb1fd8",
        "type": "function",
        "z": "dd62ac133fb1360c",
        "g": "2a6fd50769b56baf",
        "name": "Compute total current jugs active",
        "func": "if (msg.payload == undefined || msg.payload.length == 0){\n    msg.payload = 0;\n    return msg;\n}\n\nlet sum = 0;\nmsg.payload.forEach(function(element) {\n    if (element != 0.0)\n        sum += 1\n});\nmsg.payload = sum;\nsum = 0;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 460,
        "wires": [
            [
                "fcc269dc861c255c"
            ]
        ]
    },
    {
        "id": "7a088ebc13b22c17",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 6",
        "links": [
            "62c0ce56e6d2d453"
        ],
        "x": 255,
        "y": 380,
        "wires": [
            [
                "c82c75d3b593411b",
                "12d815057cd57334"
            ]
        ]
    },
    {
        "id": "62c0ce56e6d2d453",
        "type": "link out",
        "z": "dd62ac133fb1360c",
        "name": "link out 6",
        "mode": "link",
        "links": [
            "7a088ebc13b22c17",
            "69dfaeb2e0718c27"
        ],
        "x": 865,
        "y": 120,
        "wires": []
    },
    {
        "id": "c82c75d3b593411b",
        "type": "http request",
        "z": "dd62ac133fb1360c",
        "g": "2a6fd50769b56baf",
        "name": "Get Litres Per Second",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{thing_id}}/Properties/litresPerSecond",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 440,
        "y": 460,
        "wires": [
            [
                "04502fd62b09576f"
            ]
        ]
    },
    {
        "id": "0c96d057bbeba1ac",
        "type": "join",
        "z": "dd62ac133fb1360c",
        "g": "2a6fd50769b56baf",
        "name": "Merge all jugs values",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "thing_id",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "",
        "reduceRight": true,
        "reduceExp": "msg.payload\t",
        "reduceInit": "0",
        "reduceInitType": "num",
        "reduceFixup": "",
        "x": 880,
        "y": 460,
        "wires": [
            [
                "2ad5bd5afacb1fd8"
            ]
        ]
    },
    {
        "id": "04502fd62b09576f",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "2a6fd50769b56baf",
        "name": "Set litresPerSecond",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.rows[0].litresPerSecond",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 460,
        "wires": [
            [
                "0c96d057bbeba1ac"
            ]
        ]
    },
    {
        "id": "fcc269dc861c255c",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "2a6fd50769b56baf",
        "group": "2dab9229986fd1ba",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Num of jugs active",
        "label": "Number of jugs currently sending data:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 1210,
        "y": 520,
        "wires": []
    },
    {
        "id": "fb708c2fcfc9c453",
        "type": "function",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Compute total alert for low filter (20%)",
        "func": "let sum = 0;\nmsg.payload.forEach(function(pair) {\n    if (pair[0] >= pair[1])\n        sum += 1;\n});\nmsg.payload = sum;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 700,
        "wires": [
            [
                "17ca1b2582d81a62",
                "3d45bdf91619d41e"
            ]
        ]
    },
    {
        "id": "c2d21a8e765e0a8d",
        "type": "http request",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Get Filter Capacity",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{thing_id}}/Properties/filterCapacity",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": true,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 430,
        "y": 640,
        "wires": [
            [
                "f9bff4e17ea17d24"
            ]
        ]
    },
    {
        "id": "f9bff4e17ea17d24",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Set filterCapacity",
        "rules": [
            {
                "t": "set",
                "p": "filterCapacity",
                "pt": "msg",
                "to": "payload.rows[0].filterCapacity",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 640,
        "wires": [
            [
                "f00e83fd74bdad42"
            ]
        ]
    },
    {
        "id": "f00e83fd74bdad42",
        "type": "http request",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Get Filter Usage",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://212.78.1.205:8080/Thingworx/Things/Jug{{thing_id}}/Properties/totalLitresFilter",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "basic",
        "senderr": false,
        "headers": [
            {
                "keyType": "Accept",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            },
            {
                "keyType": "Content-Type",
                "keyValue": "",
                "valueType": "application/json",
                "valueValue": ""
            }
        ],
        "x": 860,
        "y": 640,
        "wires": [
            [
                "6dde29be83f4a808"
            ]
        ]
    },
    {
        "id": "6dde29be83f4a808",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Set filter usage",
        "rules": [
            {
                "t": "set",
                "p": "filterUsage",
                "pt": "msg",
                "to": "payload.rows[0].totalLitresFilter",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[msg.filterUsage,msg.filterCapacity]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1080,
        "y": 640,
        "wires": [
            [
                "e3ece40c497798c1"
            ]
        ]
    },
    {
        "id": "17ca1b2582d81a62",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "",
        "group": "12c2e9b2a697267d",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Num of low-filter alerts currently triggered",
        "label": "liters",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "5",
        "colors": [
            "#29ffe6",
            "#fff700",
            "#ff0059"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 1140,
        "y": 700,
        "wires": []
    },
    {
        "id": "e3ece40c497798c1",
        "type": "join",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "Merge all jugs values",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "thing_id",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "",
        "reduceRight": true,
        "reduceExp": "msg.payload\t",
        "reduceInit": "0",
        "reduceInitType": "num",
        "reduceFixup": "",
        "x": 480,
        "y": 700,
        "wires": [
            [
                "fb708c2fcfc9c453"
            ]
        ]
    },
    {
        "id": "3d45bdf91619d41e",
        "type": "ui_chart",
        "z": "dd62ac133fb1360c",
        "g": "e5db3ff7e0f7bdc2",
        "name": "",
        "group": "12c2e9b2a697267d",
        "order": 2,
        "width": "0",
        "height": "0",
        "label": "Alerts triggered (week)",
        "chartType": "line",
        "legend": "false",
        "xformat": "D/M",
        "interpolate": "step",
        "nodata": "",
        "dot": true,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#ffa200",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1100,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "2e8fa7ec9d191f25",
        "type": "ui_chart",
        "z": "dd62ac133fb1360c",
        "g": "99bd9f011057c2f8",
        "name": "",
        "group": "4bfb72e0581a07c0",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Cumulative of users registered (day)",
        "chartType": "line",
        "legend": "false",
        "xformat": "D/M",
        "interpolate": "step",
        "nodata": "",
        "dot": true,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#44ff00",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 930,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "9de3a121d9fea562",
        "type": "delay",
        "z": "dd62ac133fb1360c",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 230,
        "y": 1340,
        "wires": [
            [
                "96122b6e803914d0"
            ]
        ]
    },
    {
        "id": "ed3067e7caae1618",
        "type": "ui_chart",
        "z": "dd62ac133fb1360c",
        "g": "261acb4b06f35df7",
        "name": "",
        "group": "2dab9229986fd1ba",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Cumulative of jugs registered (min)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "step",
        "nodata": "",
        "dot": true,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#e100ff",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 940,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "b4bb400f7fb5444d",
        "type": "link out",
        "z": "dd62ac133fb1360c",
        "name": "link out 7",
        "mode": "link",
        "links": [
            "bc2ea44de7c98582",
            "97382bb942b28a70",
            "767e5feb895e7f58"
        ],
        "x": 255,
        "y": 200,
        "wires": []
    },
    {
        "id": "bc2ea44de7c98582",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 7",
        "links": [
            "b4bb400f7fb5444d"
        ],
        "x": 255,
        "y": 1140,
        "wires": [
            [
                "fffcf2415ff35daf"
            ]
        ]
    },
    {
        "id": "97382bb942b28a70",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 8",
        "links": [
            "b4bb400f7fb5444d"
        ],
        "x": 115,
        "y": 1340,
        "wires": [
            [
                "9de3a121d9fea562"
            ]
        ]
    },
    {
        "id": "69dfaeb2e0718c27",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 9",
        "links": [
            "62c0ce56e6d2d453"
        ],
        "x": 255,
        "y": 640,
        "wires": [
            [
                "c2d21a8e765e0a8d"
            ]
        ]
    },
    {
        "id": "1b5612176c75fd15",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "",
        "group": "c27372d8e95188d1",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Plastic Saved Objective: 10 Kg",
        "label": "kg",
        "format": "{{msg.payload | number: 2}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#f02400",
            "#fbff00",
            "#44ff00"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 950,
        "y": 960,
        "wires": []
    },
    {
        "id": "33457bfaf6556358",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "261acb4b06f35df7",
        "name": "",
        "group": "c73a3a9fe70498d5",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Jugs Registered Objective: 10",
        "label": "jugs",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#f02400",
            "#fbff00",
            "#44ff00"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 930,
        "y": 1220,
        "wires": []
    },
    {
        "id": "e7bd29cb35dc2be0",
        "type": "ui_gauge",
        "z": "dd62ac133fb1360c",
        "g": "99bd9f011057c2f8",
        "name": "",
        "group": "cdbb240eb1898b91",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "User Registered Objective: 10",
        "label": "users",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#f02400",
            "#fbff00",
            "#44ff00"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 910,
        "y": 1420,
        "wires": []
    },
    {
        "id": "9a21dec140558ec4",
        "type": "catch",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "HTTP Catch",
        "scope": [
            "12d815057cd57334",
            "c82c75d3b593411b",
            "c2d21a8e765e0a8d",
            "f00e83fd74bdad42"
        ],
        "uncaught": false,
        "x": 410,
        "y": 1760,
        "wires": [
            [
                "9eb6688fb3790834"
            ]
        ]
    },
    {
        "id": "9eb6688fb3790834",
        "type": "delay",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 580,
        "y": 1760,
        "wires": [
            [
                "48549ff50829816e"
            ]
        ]
    },
    {
        "id": "48549ff50829816e",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "Craft error msg",
        "rules": [
            {
                "t": "set",
                "p": "error",
                "pt": "msg",
                "to": "Error while performing HTTP Requests",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 1760,
        "wires": [
            [
                "451e852607a62c46"
            ]
        ]
    },
    {
        "id": "451e852607a62c46",
        "type": "debug",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "Print error (Dashboard)",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "error",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 1760,
        "wires": []
    },
    {
        "id": "e55c49e819e6e582",
        "type": "catch",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "Computation Catch",
        "scope": [
            "cd95edaaaf747c92",
            "4eb1c96a4b440d38"
        ],
        "uncaught": false,
        "x": 430,
        "y": 1800,
        "wires": [
            []
        ]
    },
    {
        "id": "0d496130a175a9fe",
        "type": "delay",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 620,
        "y": 1800,
        "wires": [
            [
                "ebae16586d820da2"
            ]
        ]
    },
    {
        "id": "ebae16586d820da2",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "85f31b0f7e802da4",
        "name": "Craft error msg",
        "rules": [
            {
                "t": "set",
                "p": "error",
                "pt": "msg",
                "to": "Error while performing Computation of Avg and/or Sum",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1800,
        "wires": [
            [
                "451e852607a62c46"
            ]
        ]
    },
    {
        "id": "ae2b33962a87399a",
        "type": "calculator",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "Money plastic",
        "inputMsgField": "payload",
        "outputMsgField": "payload",
        "operation": "mult",
        "constant": "0.2",
        "round": false,
        "truncate": false,
        "decimals": 0,
        "decimals2": 0,
        "x": 420,
        "y": 940,
        "wires": [
            [
                "0956b5d39aba1b9f"
            ]
        ]
    },
    {
        "id": "a492687f220674ec",
        "type": "calculator",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "Money jug",
        "inputMsgField": "payload",
        "outputMsgField": "payload",
        "operation": "mult",
        "constant": "0.08",
        "round": false,
        "truncate": false,
        "decimals": 0,
        "decimals2": 0,
        "x": 410,
        "y": 980,
        "wires": [
            [
                "cc54a4dbd8fd882f"
            ]
        ]
    },
    {
        "id": "0956b5d39aba1b9f",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "group": "a6a64a541ae8c000",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "€ spent with plastics",
        "label": "€ spent with plastics",
        "format": "{{msg.payload | number: 2}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 620,
        "y": 940,
        "wires": []
    },
    {
        "id": "cc54a4dbd8fd882f",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "group": "a6a64a541ae8c000",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "€ spent with jugs",
        "label": "€ spent with jugs",
        "format": "{{msg.payload | number: 2}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 610,
        "y": 980,
        "wires": []
    },
    {
        "id": "a4d6a0147eedd8e8",
        "type": "calculator",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "name": "Money saving",
        "inputMsgField": "payload",
        "outputMsgField": "payload",
        "operation": "mult",
        "constant": "0.12",
        "round": false,
        "truncate": false,
        "decimals": 0,
        "decimals2": 0,
        "x": 420,
        "y": 1020,
        "wires": [
            [
                "daa275236cb1cf09"
            ]
        ]
    },
    {
        "id": "daa275236cb1cf09",
        "type": "ui_text",
        "z": "dd62ac133fb1360c",
        "g": "d8af04f52759052d",
        "group": "a6a64a541ae8c000",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "€ saved",
        "label": "€ saved",
        "format": "{{msg.payload | number: 2}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "Verdana,Verdana,Geneva,sans-serif",
        "fontSize": "16",
        "color": "#000000",
        "x": 580,
        "y": 1020,
        "wires": []
    },
    {
        "id": "767e5feb895e7f58",
        "type": "link in",
        "z": "dd62ac133fb1360c",
        "name": "link in 29",
        "links": [
            "b4bb400f7fb5444d"
        ],
        "x": 285,
        "y": 1560,
        "wires": [
            [
                "a113a6d1a7a1ea63"
            ]
        ]
    },
    {
        "id": "a113a6d1a7a1ea63",
        "type": "postgresql",
        "z": "dd62ac133fb1360c",
        "g": "5b2449d89192a504",
        "name": "Select Jugs",
        "query": "SELECT id, lat, lon FROM JugTable;",
        "postgreSQLConfig": "647f7f903ce97865",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 410,
        "y": 1560,
        "wires": [
            [
                "9bc749ad4f114060"
            ]
        ]
    },
    {
        "id": "2bb09d515ea0789f",
        "type": "inject",
        "z": "dd62ac133fb1360c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 1620,
        "wires": [
            [
                "a113a6d1a7a1ea63"
            ]
        ]
    },
    {
        "id": "dc5aa2cfa5df5e61",
        "type": "ui_worldmap",
        "z": "dd62ac133fb1360c",
        "g": "5b2449d89192a504",
        "group": "2315b68dc8088d18",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "lat": "41.89053239676532",
        "lon": "12.479681319124168",
        "zoom": "5",
        "layer": "OSMG",
        "cluster": "",
        "maxage": "10",
        "usermenu": "show",
        "layers": "hide",
        "panit": "false",
        "panlock": "false",
        "zoomlock": "false",
        "hiderightclick": "true",
        "coords": "none",
        "showgrid": "false",
        "showruler": "false",
        "allowFileDrop": "false",
        "path": "/worldmap",
        "overlist": "DR,CO,RA,DN,HM",
        "maplist": "OSMG,OSMC,EsriC,EsriS,EsriT,EsriDG,UKOS",
        "mapname": "",
        "mapurl": "",
        "mapopt": "",
        "mapwms": false,
        "x": 1020,
        "y": 1560,
        "wires": []
    },
    {
        "id": "ed633ab67bec359b",
        "type": "change",
        "z": "dd62ac133fb1360c",
        "g": "5b2449d89192a504",
        "name": "Create json position",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"name\":msg.payload.id, \"lat\":msg.payload.lat, \"lon\":msg.payload.lon}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 1560,
        "wires": [
            [
                "dc5aa2cfa5df5e61"
            ]
        ]
    },
    {
        "id": "9bc749ad4f114060",
        "type": "split",
        "z": "dd62ac133fb1360c",
        "g": "5b2449d89192a504",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 570,
        "y": 1560,
        "wires": [
            [
                "ed633ab67bec359b"
            ]
        ]
    },
    {
        "id": "eb0e1351ff4cb256",
        "type": "mqtt in",
        "z": "4c20aa2ac87fc1e6",
        "g": "f74c838012730271",
        "name": "",
        "topic": "/Thingworx/Jug3/litresPerSecond",
        "qos": "0",
        "datatype": "auto-detect",
        "broker": "c77abff0c3609a0d",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 290,
        "y": 140,
        "wires": [
            [
                "14f845b4086a8052"
            ]
        ]
    },
    {
        "id": "14f845b4086a8052",
        "type": "debug",
        "z": "4c20aa2ac87fc1e6",
        "g": "f74c838012730271",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 140,
        "wires": []
    }
]